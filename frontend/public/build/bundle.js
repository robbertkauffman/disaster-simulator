var app=function(t){"use strict";function e(){}function r(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(r)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a,u;function c(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function f(t,e){t.appendChild(e)}function h(t,e,r){t.insertBefore(e,r||null)}function l(t){t.parentNode.removeChild(t)}function p(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function d(t){return document.createElement(t)}function g(t){return document.createTextNode(t)}function y(){return g(" ")}function m(){return g("")}function v(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function b(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function _(t,e){for(let r=0;r<t.options.length;r+=1){const n=t.options[r];if(n.__value===e)return void(n.selected=!0)}t.selectedIndex=-1}function E(t){u=t}function x(){if(!u)throw new Error("Function called outside component initialization");return u}function S(t){x().$$.on_mount.push(t)}function O(t){x().$$.after_update.push(t)}function j(t){x().$$.on_destroy.push(t)}const A=[],$=[],N=[],B=[],I=Promise.resolve();let R=!1;function T(t){N.push(t)}function U(t){B.push(t)}const C=new Set;let M=0;function P(){const t=u;do{for(;M<A.length;){const t=A[M];M++,E(t),k(t.$$)}for(E(null),A.length=0,M=0;$.length;)$.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];C.has(e)||(C.add(e),e())}N.length=0}while(A.length);for(;B.length;)B.pop()();R=!1,C.clear(),E(t)}function k(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const L=new Set;let D;function H(){D={r:0,c:[],p:D}}function F(){D.r||o(D.c),D=D.p}function q(t,e){t&&t.i&&(L.delete(t),t.i(e))}function J(t,e,r,n){if(t&&t.o){if(L.has(t))return;L.add(t),D.c.push((()=>{L.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}}function V(t,e,r){const n=t.$$.props[e];void 0!==n&&(t.$$.bound[n]=r,r(t.$$.ctx[n]))}function z(t){t&&t.c()}function W(t,e,n,s){const{fragment:a,on_mount:u,on_destroy:c,after_update:f}=t.$$;a&&a.m(e,n),s||T((()=>{const e=u.map(r).filter(i);c?c.push(...e):o(e),t.$$.on_mount=[]})),f.forEach(T)}function Z(t,e){const r=t.$$;null!==r.fragment&&(o(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Y(t,e){-1===t.$$.dirty[0]&&(A.push(t),R||(R=!0,I.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function G(t,r,i,s,a,c,f,h=[-1]){const p=u;E(t);const d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(p?p.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:r.target||p.$$.root};f&&f(d.root);let g=!1;if(d.ctx=i?i(t,r.props||{},((e,r,...n)=>{const o=n.length?n[0]:r;return d.ctx&&a(d.ctx[e],d.ctx[e]=o)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](o),g&&Y(t,e)),r})):[],d.update(),g=!0,o(d.before_update),d.fragment=!!s&&s(d.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);d.fragment&&d.fragment.l(t),t.forEach(l)}else d.fragment&&d.fragment.c();r.intro&&q(t.$$.fragment),W(t,r.target,r.anchor,r.customElement),P()}E(p)}class K{$destroy(){Z(this,1),this.$destroy=e}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const X=[];const Q=function(t,r=e){let n;const o=new Set;function i(e){if(s(t,e)&&(t=e,n)){const e=!X.length;for(const e of o)e[1](),X.push(e,t);if(e){for(let t=0;t<X.length;t+=2)X[t][0](X[t+1]);X.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(s,a=e){const u=[s,a];return o.add(u),1===o.size&&(n=r(i)||e),s(t),()=>{o.delete(u),0===o.size&&(n(),n=null)}}}}(!1);function tt(t,e,r){const n=t.slice();return n[5]=e[r],n}function et(t){let e,r,n,o,i,s=t[0].toUpperCase()+"",a=t[1],u=[];for(let e=0;e<a.length;e+=1)u[e]=rt(tt(t,a,e));return{c(){e=d("div"),r=d("h1"),n=g("App log — "),o=g(s),i=y();for(let t=0;t<u.length;t+=1)u[t].c();b(r,"class","display-6"),b(e,"class","col")},m(t,s){h(t,e,s),f(e,r),f(r,n),f(r,o),f(e,i);for(let t=0;t<u.length;t+=1)u[t].m(e,null)},p(t,r){if(1&r&&s!==(s=t[0].toUpperCase()+"")&&w(o,s),2&r){let n;for(a=t[1],n=0;n<a.length;n+=1){const o=tt(t,a,n);u[n]?u[n].p(o,r):(u[n]=rt(o),u[n].c(),u[n].m(e,null))}for(;n<u.length;n+=1)u[n].d(1);u.length=a.length}},d(t){t&&l(e),p(u,t)}}}function rt(t){let e,r,n,o,i,s,a,u,c,p,y=Qi(t[5].ts.$date)+"",m=t[5].operation+"",v=t[5].latency+"";return{c(){e=d("p"),r=d("span"),n=g(y),o=g(":"),i=g(" '"),s=g(m),a=g("' in "),u=g(v),c=g("ms..."),b(e,"class",p="log "+(t[5].success?"text-success":"text-danger")+" svelte-o9crug")},m(t,l){h(t,e,l),f(e,r),f(r,n),f(r,o),f(e,i),f(e,s),f(e,a),f(e,u),f(e,c)},p(t,r){2&r&&y!==(y=Qi(t[5].ts.$date)+"")&&w(n,y),2&r&&m!==(m=t[5].operation+"")&&w(s,m),2&r&&v!==(v=t[5].latency+"")&&w(u,v),2&r&&p!==(p="log "+(t[5].success?"text-success":"text-danger")+" svelte-o9crug")&&b(e,"class",p)},d(t){t&&l(e)}}}function nt(t){let r,n=t[1].length>0&&et(t);return{c(){n&&n.c(),r=m()},m(t,e){n&&n.m(t,e),h(t,r,e)},p(t,[e]){t[1].length>0?n?n.p(t,e):(n=et(t),n.c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},i:e,o:e,d(t){n&&n.d(t),t&&l(r)}}}function ot(t,e,r){let n,{region:o="REGION"}=e,{appServerEndpoint:i}=e,s=[];async function a(){try{const t=await fetch(i+"/requestlog");r(1,s=await t.json())}catch(t){console.log(`Error while fetching request log: ${t}`)}}return S((()=>{})),j((()=>{clearInterval(n)})),Q.subscribe((t=>{t?n=setInterval(a,1e3):clearInterval(n)})),t.$$set=t=>{"region"in t&&r(0,o=t.region),"appServerEndpoint"in t&&r(2,i=t.appServerEndpoint)},[o,s,i]}class it extends K{constructor(t){super(),G(this,t,ot,nt,s,{region:0,appServerEndpoint:2})}}function st(t){let r,n,o,i,s,a,u,p,m=t[0].toUpperCase()+"";return{c(){r=d("div"),n=d("figure"),o=d("figcaption"),i=g("App server — "),s=g(m),a=y(),u=d("img"),b(o,"class","figure-caption text-center"),c(u.src,p="img/appserver.png")||b(u,"src","img/appserver.png"),b(u,"class","figure-img svelte-1xxiser"),b(u,"alt","appserver"),b(n,"class","figure"),b(r,"class","col-3 text-center")},m(e,c){h(e,r,c),f(r,n),f(n,o),f(o,i),f(o,s),f(n,a),f(n,u),t[4](u)},p(t,[e]){1&e&&m!==(m=t[0].toUpperCase()+"")&&w(s,m)},i:e,o:e,d(e){e&&l(r),t[4](null)}}}function at(t,e,r){let n,o,{region:i="REGION"}=e,{mongoNodes:s}=e,{readPreference:a="primary"}=e;return O((()=>{!function(){if(s.length>1){const t=s.findIndex((t=>t.type.toLowerCase()===a));if(-1!==t&&s[t].iconElm){const e=new LeaderLine(n,s[t].iconElm,{color:"#8a795d",startSocket:"bottom",endSocket:"top"});o&&o.remove(),o=e}}}()})),t.$$set=t=>{"region"in t&&r(0,i=t.region),"mongoNodes"in t&&r(2,s=t.mongoNodes),"readPreference"in t&&r(3,a=t.readPreference)},[i,n,s,a,function(t){$[t?"unshift":"push"]((()=>{n=t,r(1,n)}))}]}class ut extends K{constructor(t){super(),G(this,t,at,st,s,{region:0,mongoNodes:2,readPreference:3})}}for(var ct=function(t){var e=vt(t),r=e[0],n=e[1];return 3*(r+n)/4-n},ft=function(t){var e,r,n=vt(t),o=n[0],i=n[1],s=new dt(function(t,e,r){return 3*(e+r)/4-r}(0,o,i)),a=0,u=i>0?o-4:o;for(r=0;r<u;r+=4)e=pt[t.charCodeAt(r)]<<18|pt[t.charCodeAt(r+1)]<<12|pt[t.charCodeAt(r+2)]<<6|pt[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===i&&(e=pt[t.charCodeAt(r)]<<2|pt[t.charCodeAt(r+1)]>>4,s[a++]=255&e);1===i&&(e=pt[t.charCodeAt(r)]<<10|pt[t.charCodeAt(r+1)]<<4|pt[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},ht=function(t){for(var e,r=t.length,n=r%3,o=[],i=16383,s=0,a=r-n;s<a;s+=i)o.push(bt(t,s,s+i>a?a:s+i));1===n?(e=t[r-1],o.push(lt[e>>2]+lt[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],o.push(lt[e>>10]+lt[e>>4&63]+lt[e<<2&63]+"="));return o.join("")},lt=[],pt=[],dt="undefined"!=typeof Uint8Array?Uint8Array:Array,gt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yt=0,mt=gt.length;yt<mt;++yt)lt[yt]=gt[yt],pt[gt.charCodeAt(yt)]=yt;function vt(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function bt(t,e,r){for(var n,o,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(lt[(o=n)>>18&63]+lt[o>>12&63]+lt[o>>6&63]+lt[63&o]);return i.join("")}pt["-".charCodeAt(0)]=62,pt["_".charCodeAt(0)]=63;var wt,_t,Et={byteLength:ct,toByteArray:ft,fromByteArray:ht},xt=function(t,e,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,c=u>>1,f=-7,h=r?o-1:0,l=r?-1:1,p=t[e+h];for(h+=l,i=p&(1<<-f)-1,p>>=-f,f+=a;f>0;i=256*i+t[e+h],h+=l,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=n;f>0;s=256*s+t[e+h],h+=l,f-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=c}return(p?-1:1)*s*Math.pow(2,i-n)},St=function(t,e,r,n,o,i){var s,a,u,c=8*i-o-1,f=(1<<c)-1,h=f>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?l/u:l*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=f?(a=0,s=f):s+h>=1?(a=(e*u-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[r+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[r+p]=255&s,p+=d,s/=256,c-=8);t[r+p-d]|=128*g},Ot=(wt=function(t,e){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=i,e.SlowBuffer=function(t){return+t!=t&&(t=0),i.alloc(+t)},e.INSPECT_MAX_BYTES=50;var n=2147483647;function o(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,i.prototype),e}function i(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,r)}function s(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!i.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|l(t,e),n=o(r),s=n.write(t,e);return s!==r&&(n=n.slice(0,s)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(k(t,Uint8Array)){var e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return c(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t));if(k(t,ArrayBuffer)||t&&k(t.buffer,ArrayBuffer))return f(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(k(t,SharedArrayBuffer)||t&&k(t.buffer,SharedArrayBuffer)))return f(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return i.from(n,e,r);var s=function(t){if(i.isBuffer(t)){var e=0|h(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||L(t.length)?o(0):c(t):"Buffer"===t.type&&Array.isArray(t.data)?c(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return i.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(t))}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),o(t<0?0:0|h(t))}function c(t){for(var e=t.length<0?0:0|h(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function f(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,i.prototype),n}function h(t){if(t>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function l(t,e){if(i.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||k(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(t));var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return C(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(t).length;default:if(o)return n?-1:C(t).length;e=(""+e).toLowerCase(),o=!0}}function p(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,r);case"utf8":case"utf-8":return x(this,e,r);case"ascii":return O(this,e,r);case"latin1":case"binary":return j(this,e,r);case"base64":return E(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function d(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function g(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),L(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=i.from(e,n)),i.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,o){var i,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var f=-1;for(i=r;i<a;i++)if(c(t,i)===c(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===u)return f*s}else-1!==f&&(i-=i-f),f=-1}else for(r+u>a&&(r=a-u),i=r;i>=0;i--){for(var h=!0,l=0;l<u;l++)if(c(t,i+l)!==c(e,l)){h=!1;break}if(h)return i}return-1}function m(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(L(a))return s;t[r+s]=a}return s}function v(t,e,r,n){return P(C(e,t.length-r),t,r,n)}function b(t,e,r,n){return P(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function w(t,e,r,n){return P(M(e),t,r,n)}function _(t,e,r,n){return P(function(t,e){for(var r,n,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function E(t,e,r){return 0===e&&r===t.length?Et.fromByteArray(t):Et.fromByteArray(t.slice(e,r))}function x(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,s,a,u,c=t[o],f=null,h=c>239?4:c>223?3:c>191?2:1;if(o+h<=r)switch(h){case 1:c<128&&(f=c);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&c)<<6|63&i)>127&&(f=u);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(u=(15&c)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(f=u)}null===f?(f=65533,h=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),o+=h}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=S));return r}(n)}e.kMaxLength=n,i.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(t,e,r){return s(t,e,r)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(t,e,r){return function(t,e,r){return a(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},i.allocUnsafe=function(t){return u(t)},i.allocUnsafeSlow=function(t){return u(t)},i.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==i.prototype},i.compare=function(t,e){if(k(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),k(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,o=0,s=Math.min(r,n);o<s;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=i.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var s=t[r];if(k(s,Uint8Array))o+s.length>n.length?i.from(s).copy(n,o):Uint8Array.prototype.set.call(n,s,o);else{if(!i.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,o)}o+=s.length}return n},i.byteLength=l,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},i.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?x(this,0,t):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r&&(i.prototype[r]=i.prototype.inspect),i.prototype.compare=function(t,e,r,n,o){if(k(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(t));if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),u=Math.min(s,a),c=this.slice(n,o),f=t.slice(e,r),h=0;h<u;++h)if(c[h]!==f[h]){s=c[h],a=f[h];break}return s<a?-1:a<s?1:0},i.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},i.prototype.indexOf=function(t,e,r){return g(this,t,e,r,!0)},i.prototype.lastIndexOf=function(t,e,r){return g(this,t,e,r,!1)},i.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return v(this,t,e,r);case"ascii":case"latin1":case"binary":return b(this,t,e,r);case"base64":return w(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function O(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function j(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function A(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=e;i<r;++i)o+=D[t[i]];return o}function $(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length-1;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function N(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,r,n,o,s){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function I(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(t,e,r,n,o){return e=+e,r>>>=0,o||I(t,0,r,4),St(t,e,r,n,23,4),r+4}function T(t,e,r,n,o){return e=+e,r>>>=0,o||I(t,0,r,8),St(t,e,r,n,52,8),r+8}i.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,i.prototype),n},i.prototype.readUintLE=i.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},i.prototype.readUintBE=i.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},i.prototype.readUint8=i.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},i.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),xt(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),xt(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),xt(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),xt(this,t,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||B(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||B(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},i.prototype.writeUint8=i.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,1,255,0),this[e]=255&t,e+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*r-1);B(this,t,e,r,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},i.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var o=Math.pow(2,8*r-1);B(this,t,e,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},i.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},i.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},i.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},i.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},i.prototype.writeFloatLE=function(t,e,r){return R(this,t,e,!0,r)},i.prototype.writeFloatBE=function(t,e,r){return R(this,t,e,!1,r)},i.prototype.writeDoubleLE=function(t,e,r){return T(this,t,e,!0,r)},i.prototype.writeDoubleBE=function(t,e,r){return T(this,t,e,!1,r)},i.prototype.copy=function(t,e,r,n){if(!i.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),o},i.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var o=t.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(t=o)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=i.isBuffer(t)?t:i.from(t,n),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=a[s%u]}return this};var U=/[^+/0-9A-Za-z-_]/g;function C(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function M(t){return Et.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function P(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function k(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function L(t){return t!=t}var D=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,o=0;o<16;++o)e[n+o]=t[r]+t[o];return e}()},wt(_t={exports:{}},_t.exports),_t.exports),jt=Ot.Buffer;
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function At(t){return t&&t.Math==Math&&t}function $t(){return At("object"==typeof globalThis&&globalThis)||At("object"==typeof window&&window)||At("object"==typeof self&&self)||At("object"==typeof global&&global)||Function("return this")()}Ot.SlowBuffer,Ot.INSPECT_MAX_BYTES,Ot.kMaxLength;var Nt=function(t){var e,r="object"==typeof(e=$t()).navigator&&"ReactNative"===e.navigator.product?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=jt.alloc(t),o=0;o<t;++o)n[o]=Math.floor(256*Math.random());return n},Bt=function(){if("undefined"!=typeof window){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues)return function(e){return t.getRandomValues(jt.alloc(e))}}if("undefined"!=typeof global&&global.crypto&&global.crypto.getRandomValues)return function(t){return global.crypto.getRandomValues(jt.alloc(t))};var e;try{e=require("crypto").randomBytes}catch(t){}return e||Nt}();function It(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function Rt(t){return"object"==typeof t&&null!==t}function Tt(t,e){var r=!1;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return r||(console.warn(e),r=!0),t.apply(this,n)}}function Ut(t){if(ArrayBuffer.isView(t))return jt.from(t.buffer,t.byteOffset,t.byteLength);if(e=t,["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e)))return jt.from(t);var e;throw new TypeError("Must use either Buffer or TypedArray")}var Ct=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,Mt=function(t){return"string"==typeof t&&Ct.test(t)},Pt=function(t){if(!Mt(t))throw new TypeError('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var e=t.replace(/-/g,"");return jt.from(e,"hex")},kt=function(t,e){return void 0===e&&(e=!0),e?t.toString("hex",0,4)+"-"+t.toString("hex",4,6)+"-"+t.toString("hex",6,8)+"-"+t.toString("hex",8,10)+"-"+t.toString("hex",10,16):t.toString("hex")},Lt=Symbol("id"),Dt=function(){function t(e){if(void 0===e)this.id=t.generate();else if(e instanceof t)this[Lt]=jt.from(e.id),this.__id=e.__id;else if(ArrayBuffer.isView(e)&&16===e.byteLength)this.id=Ut(e);else{if("string"!=typeof e)throw new TypeError("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");this.id=Pt(e)}}return Object.defineProperty(t.prototype,"id",{get:function(){return this[Lt]},set:function(e){this[Lt]=e,t.cacheHexString&&(this.__id=kt(e))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(e){if(void 0===e&&(e=!0),t.cacheHexString&&this.__id)return this.__id;var r=kt(this.id,e);return t.cacheHexString&&(this.__id=r),r},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){if(!e)return!1;if(e instanceof t)return e.id.equals(this.id);try{return new t(e).id.equals(this.id)}catch(t){return!1}},t.prototype.toBinary=function(){return new Ht(this.id,Ht.SUBTYPE_UUID)},t.generate=function(){var t=Bt(16);return t[6]=15&t[6]|64,t[8]=63&t[8]|128,jt.from(t)},t.isValid=function(e){if(!e)return!1;if(e instanceof t)return!0;if("string"==typeof e)return Mt(e);if(It(e)){if(16!==e.length)return!1;try{return parseInt(e[6].toString(16)[0],10)===Ht.SUBTYPE_UUID}catch(t){return!1}}return!1},t.createFromHexString=function(e){return new t(Pt(e))},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'+this.toHexString()+'")'},t}();Object.defineProperty(Dt.prototype,"_bsontype",{value:"UUID"});var Ht=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);if(!(null==e||"string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||Array.isArray(e)))throw new TypeError("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=null!=r?r:t.BSON_BINARY_SUBTYPE_DEFAULT,null==e?(this.buffer=jt.alloc(t.BUFFER_SIZE),this.position=0):("string"==typeof e?this.buffer=jt.from(e,"binary"):Array.isArray(e)?this.buffer=jt.from(e):this.buffer=Ut(e),this.position=this.buffer.byteLength)}return t.prototype.put=function(e){if("string"==typeof e&&1!==e.length)throw new TypeError("only accepts single character String");if("number"!=typeof e&&1!==e.length)throw new TypeError("only accepts single character Uint8Array or Array");var r;if((r="string"==typeof e?e.charCodeAt(0):"number"==typeof e?e:e[0])<0||r>255)throw new TypeError("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=jt.alloc(t.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},t.prototype.write=function(t,e){if(e="number"==typeof e?e:this.position,this.buffer.length<e+t.length){var r=jt.alloc(this.buffer.length+t.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r}ArrayBuffer.isView(t)?(this.buffer.set(Ut(t),e),this.position=e+t.byteLength>this.position?e+t.length:this.position):"string"==typeof t&&(this.buffer.write(t,e,t.length,"binary"),this.position=e+t.length>this.position?e+t.length:this.position)},t.prototype.read=function(t,e){return e=e&&e>0?e:this.position,this.buffer.slice(t,t+e)},t.prototype.value=function(t){return(t=!!t)&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},t.prototype.length=function(){return this.position},t.prototype.toJSON=function(){return this.buffer.toString("base64")},t.prototype.toString=function(t){return this.buffer.toString(t)},t.prototype.toExtendedJSON=function(t){t=t||{};var e=this.buffer.toString("base64"),r=Number(this.sub_type).toString(16);return t.legacy?{$binary:e,$type:1===r.length?"0"+r:r}:{$binary:{base64:e,subType:1===r.length?"0"+r:r}}},t.prototype.toUUID=function(){if(this.sub_type===t.SUBTYPE_UUID)return new Dt(this.buffer.slice(0,this.position));throw new Error('Binary sub_type "'+this.sub_type+'" is not supported for converting to UUID. Only "'+t.SUBTYPE_UUID+'" is currently supported.')},t.fromExtendedJSON=function(e,r){var n,o;if(r=r||{},"$binary"in e?r.legacy&&"string"==typeof e.$binary&&"$type"in e?(o=e.$type?parseInt(e.$type,16):0,n=jt.from(e.$binary,"base64")):"string"!=typeof e.$binary&&(o=e.$binary.subType?parseInt(e.$binary.subType,16):0,n=jt.from(e.$binary.base64,"base64")):"$uuid"in e&&(o=4,n=Pt(e.$uuid)),!n)throw new TypeError("Unexpected Binary Extended JSON format "+JSON.stringify(e));return new t(n,o)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Binary(Buffer.from("'+this.value(!0).toString("hex")+'", "hex"), '+this.sub_type+")"},t.BSON_BINARY_SUBTYPE_DEFAULT=0,t.BUFFER_SIZE=256,t.SUBTYPE_DEFAULT=0,t.SUBTYPE_FUNCTION=1,t.SUBTYPE_BYTE_ARRAY=2,t.SUBTYPE_UUID_OLD=3,t.SUBTYPE_UUID=4,t.SUBTYPE_MD5=5,t.SUBTYPE_USER_DEFINED=128,t}();Object.defineProperty(Ht.prototype,"_bsontype",{value:"Binary"});var Ft=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);this.code=e,this.scope=r}return t.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},t.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},t.fromExtendedJSON=function(e){return new t(e.$code,e.$scope)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=this.toJSON();return'new Code("'+t.code+'"'+(t.scope?", "+JSON.stringify(t.scope):"")+")"},t}();Object.defineProperty(Ft.prototype,"_bsontype",{value:"Code"});var qt=function(){function t(e,r,n,o){if(!(this instanceof t))return new t(e,r,n,o);var i=e.split(".");2===i.length&&(n=i.shift(),e=i.shift()),this.collection=e,this.oid=r,this.db=n,this.fields=o||{}}return Object.defineProperty(t.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(t.$db=this.db),t},t.prototype.toExtendedJSON=function(t){t=t||{};var e={$ref:this.collection,$id:this.oid};return t.legacy?e:(this.db&&(e.$db=this.db),e=Object.assign(e,this.fields))},t.fromExtendedJSON=function(e){var r=Object.assign({},e);return delete r.$ref,delete r.$id,delete r.$db,new t(e.$ref,e.$id,e.$db,r)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){var t=void 0===this.oid||void 0===this.oid.toString?this.oid:this.oid.toString();return'new DBRef("'+this.namespace+'", new ObjectId("'+t+'")'+(this.db?', "'+this.db+'"':"")+")"},t}();Object.defineProperty(qt.prototype,"_bsontype",{value:"DBRef"});var Jt=void 0;try{Jt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}var Vt=4294967296,zt=0x10000000000000000,Wt=zt/2,Zt={},Yt={},Gt=function(){function t(e,r,n){if(void 0===e&&(e=0),!(this instanceof t))return new t(e,r,n);"bigint"==typeof e?Object.assign(this,t.fromBigInt(e,!!r)):"string"==typeof e?Object.assign(this,t.fromString(e,!!r)):(this.low=0|e,this.high=0|r,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return t.fromBits=function(e,r,n){return new t(e,r,n)},t.fromInt=function(e,r){var n,o,i;return r?(i=0<=(e>>>=0)&&e<256)&&(o=Yt[e])?o:(n=t.fromBits(e,(0|e)<0?-1:0,!0),i&&(Yt[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(o=Zt[e])?o:(n=t.fromBits(e,e<0?-1:0,!1),i&&(Zt[e]=n),n)},t.fromNumber=function(e,r){if(isNaN(e))return r?t.UZERO:t.ZERO;if(r){if(e<0)return t.UZERO;if(e>=zt)return t.MAX_UNSIGNED_VALUE}else{if(e<=-Wt)return t.MIN_VALUE;if(e+1>=Wt)return t.MAX_VALUE}return e<0?t.fromNumber(-e,r).neg():t.fromBits(e%Vt|0,e/Vt|0,r)},t.fromBigInt=function(e,r){return t.fromString(e.toString(),r)},t.fromString=function(e,r,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t.ZERO;if("number"==typeof r?(n=r,r=!1):r=!!r,(n=n||10)<2||36<n)throw RangeError("radix");var o;if((o=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===o)return t.fromString(e.substring(1),r,n).neg();for(var i=t.fromNumber(Math.pow(n,8)),s=t.ZERO,a=0;a<e.length;a+=8){var u=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+u),n);if(u<8){var f=t.fromNumber(Math.pow(n,u));s=s.mul(f).add(t.fromNumber(c))}else s=(s=s.mul(i)).add(t.fromNumber(c))}return s.unsigned=r,s},t.fromBytes=function(e,r,n){return n?t.fromBytesLE(e,r):t.fromBytesBE(e,r)},t.fromBytesLE=function(e,r){return new t(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,r)},t.fromBytesBE=function(e,r){return new t(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],r)},t.isLong=function(t){return Rt(t)&&!0===t.__isLong__},t.fromValue=function(e,r){return"number"==typeof e?t.fromNumber(e,r):"string"==typeof e?t.fromString(e,r):t.fromBits(e.low,e.high,"boolean"==typeof r?r:e.unsigned)},t.prototype.add=function(e){t.isLong(e)||(e=t.fromValue(e));var r=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,s=e.high>>>16,a=65535&e.high,u=e.low>>>16,c=0,f=0,h=0,l=0;return h+=(l+=i+(65535&e.low))>>>16,l&=65535,f+=(h+=o+u)>>>16,h&=65535,c+=(f+=n+a)>>>16,f&=65535,c+=r+s,c&=65535,t.fromBits(h<<16|l,c<<16|f,this.unsigned)},t.prototype.and=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},t.prototype.compare=function(e){if(t.isLong(e)||(e=t.fromValue(e)),this.eq(e))return 0;var r=this.isNegative(),n=e.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},t.prototype.comp=function(t){return this.compare(t)},t.prototype.divide=function(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");if(Jt){if(!this.unsigned&&-2147483648===this.high&&-1===e.low&&-1===e.high)return this;var r=(this.unsigned?Jt.div_u:Jt.div_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,Jt.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?t.UZERO:t.ZERO;var n,o,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return t.UZERO;if(e.gt(this.shru(1)))return t.UONE;i=t.UZERO}else{if(this.eq(t.MIN_VALUE))return e.eq(t.ONE)||e.eq(t.NEG_ONE)?t.MIN_VALUE:e.eq(t.MIN_VALUE)?t.ONE:(n=this.shr(1).div(e).shl(1)).eq(t.ZERO)?e.isNegative()?t.ONE:t.NEG_ONE:(o=this.sub(e.mul(n)),i=n.add(o.div(e)));if(e.eq(t.MIN_VALUE))return this.unsigned?t.UZERO:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=t.ZERO}for(o=this;o.gte(e);){n=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),a=s<=48?1:Math.pow(2,s-48),u=t.fromNumber(n),c=u.mul(e);c.isNegative()||c.gt(o);)n-=a,c=(u=t.fromNumber(n,this.unsigned)).mul(e);u.isZero()&&(u=t.ONE),i=i.add(u),o=o.sub(c)}return i},t.prototype.div=function(t){return this.divide(t)},t.prototype.equals=function(e){return t.isLong(e)||(e=t.fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},t.prototype.eq=function(t){return this.equals(t)},t.prototype.getHighBits=function(){return this.high},t.prototype.getHighBitsUnsigned=function(){return this.high>>>0},t.prototype.getLowBits=function(){return this.low},t.prototype.getLowBitsUnsigned=function(){return this.low>>>0},t.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(t.MIN_VALUE)?64:this.neg().getNumBitsAbs();var e,r=0!==this.high?this.high:this.low;for(e=31;e>0&&0==(r&1<<e);e--);return 0!==this.high?e+33:e+1},t.prototype.greaterThan=function(t){return this.comp(t)>0},t.prototype.gt=function(t){return this.greaterThan(t)},t.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},t.prototype.gte=function(t){return this.greaterThanOrEqual(t)},t.prototype.ge=function(t){return this.greaterThanOrEqual(t)},t.prototype.isEven=function(){return 0==(1&this.low)},t.prototype.isNegative=function(){return!this.unsigned&&this.high<0},t.prototype.isOdd=function(){return 1==(1&this.low)},t.prototype.isPositive=function(){return this.unsigned||this.high>=0},t.prototype.isZero=function(){return 0===this.high&&0===this.low},t.prototype.lessThan=function(t){return this.comp(t)<0},t.prototype.lt=function(t){return this.lessThan(t)},t.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},t.prototype.lte=function(t){return this.lessThanOrEqual(t)},t.prototype.modulo=function(e){if(t.isLong(e)||(e=t.fromValue(e)),Jt){var r=(this.unsigned?Jt.rem_u:Jt.rem_s)(this.low,this.high,e.low,e.high);return t.fromBits(r,Jt.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},t.prototype.mod=function(t){return this.modulo(t)},t.prototype.rem=function(t){return this.modulo(t)},t.prototype.multiply=function(e){if(this.isZero())return t.ZERO;if(t.isLong(e)||(e=t.fromValue(e)),Jt){var r=Jt.mul(this.low,this.high,e.low,e.high);return t.fromBits(r,Jt.get_high(),this.unsigned)}if(e.isZero())return t.ZERO;if(this.eq(t.MIN_VALUE))return e.isOdd()?t.MIN_VALUE:t.ZERO;if(e.eq(t.MIN_VALUE))return this.isOdd()?t.MIN_VALUE:t.ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(t.TWO_PWR_24)&&e.lt(t.TWO_PWR_24))return t.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,i=this.low>>>16,s=65535&this.low,a=e.high>>>16,u=65535&e.high,c=e.low>>>16,f=65535&e.low,h=0,l=0,p=0,d=0;return p+=(d+=s*f)>>>16,d&=65535,l+=(p+=i*f)>>>16,p&=65535,l+=(p+=s*c)>>>16,p&=65535,h+=(l+=o*f)>>>16,l&=65535,h+=(l+=i*c)>>>16,l&=65535,h+=(l+=s*u)>>>16,l&=65535,h+=n*f+o*c+i*u+s*a,h&=65535,t.fromBits(p<<16|d,h<<16|l,this.unsigned)},t.prototype.mul=function(t){return this.multiply(t)},t.prototype.negate=function(){return!this.unsigned&&this.eq(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)},t.prototype.neg=function(){return this.negate()},t.prototype.not=function(){return t.fromBits(~this.low,~this.high,this.unsigned)},t.prototype.notEquals=function(t){return!this.equals(t)},t.prototype.neq=function(t){return this.notEquals(t)},t.prototype.ne=function(t){return this.notEquals(t)},t.prototype.or=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},t.prototype.shiftLeft=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):t.fromBits(0,this.low<<e-32,this.unsigned)},t.prototype.shl=function(t){return this.shiftLeft(t)},t.prototype.shiftRight=function(e){return t.isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?t.fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):t.fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},t.prototype.shr=function(t){return this.shiftRight(t)},t.prototype.shiftRightUnsigned=function(e){if(t.isLong(e)&&(e=e.toInt()),0===(e&=63))return this;var r=this.high;if(e<32){var n=this.low;return t.fromBits(n>>>e|r<<32-e,r>>>e,this.unsigned)}return 32===e?t.fromBits(r,0,this.unsigned):t.fromBits(r>>>e-32,0,this.unsigned)},t.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},t.prototype.shru=function(t){return this.shiftRightUnsigned(t)},t.prototype.subtract=function(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.neg())},t.prototype.sub=function(t){return this.subtract(t)},t.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},t.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*Vt+(this.low>>>0):this.high*Vt+(this.low>>>0)},t.prototype.toBigInt=function(){return BigInt(this.toString())},t.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},t.prototype.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},t.prototype.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},t.prototype.toSigned=function(){return this.unsigned?t.fromBits(this.low,this.high,!1):this},t.prototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(t.MIN_VALUE)){var r=t.fromNumber(e),n=this.div(r),o=n.mul(r).sub(this);return n.toString(e)+o.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=t.fromNumber(Math.pow(e,6),this.unsigned),s=this,a="";;){var u=s.div(i),c=(s.sub(u.mul(i)).toInt()>>>0).toString(e);if((s=u).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},t.prototype.toUnsigned=function(){return this.unsigned?this:t.fromBits(this.low,this.high,!0)},t.prototype.xor=function(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},t.prototype.eqz=function(){return this.isZero()},t.prototype.le=function(t){return this.lessThanOrEqual(t)},t.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},t.fromExtendedJSON=function(e,r){var n=t.fromString(e.$numberLong);return r&&r.relaxed?n.toNumber():n},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Long("'+this.toString()+'"'+(this.unsigned?", true":"")+")"},t.TWO_PWR_24=t.fromInt(16777216),t.MAX_UNSIGNED_VALUE=t.fromBits(-1,-1,!0),t.ZERO=t.fromInt(0),t.UZERO=t.fromInt(0,!0),t.ONE=t.fromInt(1),t.UONE=t.fromInt(1,!0),t.NEG_ONE=t.fromInt(-1),t.MAX_VALUE=t.fromBits(-1,2147483647,!1),t.MIN_VALUE=t.fromBits(0,-2147483648,!1),t}();Object.defineProperty(Gt.prototype,"__isLong__",{value:!0}),Object.defineProperty(Gt.prototype,"_bsontype",{value:"Long"});var Kt=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Xt=/^(\+|-)?(Infinity|inf)$/i,Qt=/^(\+|-)?NaN$/i,te=6111,ee=-6176,re=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),ne=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),oe=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),ie=/^([-+])?(\d+)?$/;function se(t){return!isNaN(parseInt(t,10))}function ae(t){var e=Gt.fromNumber(1e9),r=Gt.fromNumber(0);if(!(t.parts[0]||t.parts[1]||t.parts[2]||t.parts[3]))return{quotient:t,rem:r};for(var n=0;n<=3;n++)r=(r=r.shiftLeft(32)).add(new Gt(t.parts[n],0)),t.parts[n]=r.div(e).low,r=r.modulo(e);return{quotient:t,rem:r}}function ue(t,e){throw new TypeError('"'+t+'" is not a valid Decimal128 string - '+e)}var ce=function(){function t(e){if(!(this instanceof t))return new t(e);this.bytes="string"==typeof e?t.fromString(e).bytes:e}return t.fromString=function(e){var r,n=!1,o=!1,i=!1,s=0,a=0,u=0,c=0,f=0,h=[0],l=0,p=0,d=0,g=0,y=0,m=0,v=new Gt(0,0),b=new Gt(0,0),w=0;if(e.length>=7e3)throw new TypeError(e+" not a valid Decimal128 string");var _=e.match(Kt),E=e.match(Xt),x=e.match(Qt);if(!_&&!E&&!x||0===e.length)throw new TypeError(e+" not a valid Decimal128 string");if(_){var S=_[2],O=_[4],j=_[5],A=_[6];O&&void 0===A&&ue(e,"missing exponent power"),O&&void 0===S&&ue(e,"missing exponent base"),void 0===O&&(j||A)&&ue(e,"missing e before exponent")}if("+"!==e[w]&&"-"!==e[w]||(n="-"===e[w++]),!se(e[w])&&"."!==e[w]){if("i"===e[w]||"I"===e[w])return new t(jt.from(n?ne:oe));if("N"===e[w])return new t(jt.from(re))}for(;se(e[w])||"."===e[w];)"."!==e[w]?(l<34&&("0"!==e[w]||i)&&(i||(f=a),i=!0,h[p++]=parseInt(e[w],10),l+=1),i&&(u+=1),o&&(c+=1),a+=1,w+=1):(o&&ue(e,"contains multiple periods"),o=!0,w+=1);if(o&&!a)throw new TypeError(e+" not a valid Decimal128 string");if("e"===e[w]||"E"===e[w]){var $=e.substr(++w).match(ie);if(!$||!$[2])return new t(jt.from(re));y=parseInt($[0],10),w+=$[0].length}if(e[w])return new t(jt.from(re));if(d=0,l){if(g=l-1,1!==(s=u))for(;0===h[f+s-1];)s-=1}else d=0,g=0,h[0]=0,u=1,l=1,s=0;for(y<=c&&c-y>16384?y=ee:y-=c;y>te;){if((g+=1)-d>34){if(h.join("").match(/^0+$/)){y=te;break}ue(e,"overflow")}y-=1}for(;y<ee||l<u;){if(0===g&&s<l){y=ee,s=0;break}if(l<u?u-=1:g-=1,y<te)y+=1;else{if(h.join("").match(/^0+$/)){y=te;break}ue(e,"overflow")}}if(g-d+1<s){var N=a;o&&(f+=1,N+=1),n&&(f+=1,N+=1);var B=parseInt(e[f+g+1],10),I=0;if(B>=5&&(I=1,5===B))for(I=h[g]%2==1?1:0,m=f+g+2;m<N;m++)if(parseInt(e[m],10)){I=1;break}if(I)for(var R=g;R>=0;R--)if(++h[R]>9&&(h[R]=0,0===R)){if(!(y<te))return new t(jt.from(n?ne:oe));y+=1,h[R]=1}}if(v=Gt.fromNumber(0),b=Gt.fromNumber(0),0===s)v=Gt.fromNumber(0),b=Gt.fromNumber(0);else if(g-d<17){R=d;for(b=Gt.fromNumber(h[R++]),v=new Gt(0,0);R<=g;R++)b=(b=b.multiply(Gt.fromNumber(10))).add(Gt.fromNumber(h[R]))}else{R=d;for(v=Gt.fromNumber(h[R++]);R<=g-17;R++)v=(v=v.multiply(Gt.fromNumber(10))).add(Gt.fromNumber(h[R]));for(b=Gt.fromNumber(h[R++]);R<=g;R++)b=(b=b.multiply(Gt.fromNumber(10))).add(Gt.fromNumber(h[R]))}var T,U,C,M,P=function(t,e){if(!t&&!e)return{high:Gt.fromNumber(0),low:Gt.fromNumber(0)};var r=t.shiftRightUnsigned(32),n=new Gt(t.getLowBits(),0),o=e.shiftRightUnsigned(32),i=new Gt(e.getLowBits(),0),s=r.multiply(o),a=r.multiply(i),u=n.multiply(o),c=n.multiply(i);return s=s.add(a.shiftRightUnsigned(32)),a=new Gt(a.getLowBits(),0).add(u).add(c.shiftRightUnsigned(32)),{high:s=s.add(a.shiftRightUnsigned(32)),low:c=a.shiftLeft(32).add(new Gt(c.getLowBits(),0))}}(v,Gt.fromString("100000000000000000"));P.low=P.low.add(b),T=P.low,U=b,C=T.high>>>0,M=U.high>>>0,(C<M||C===M&&T.low>>>0<U.low>>>0)&&(P.high=P.high.add(Gt.fromNumber(1))),r=y+6176;var k={low:Gt.fromNumber(0),high:Gt.fromNumber(0)};P.high.shiftRightUnsigned(49).and(Gt.fromNumber(1)).equals(Gt.fromNumber(1))?(k.high=k.high.or(Gt.fromNumber(3).shiftLeft(61)),k.high=k.high.or(Gt.fromNumber(r).and(Gt.fromNumber(16383).shiftLeft(47))),k.high=k.high.or(P.high.and(Gt.fromNumber(0x7fffffffffff)))):(k.high=k.high.or(Gt.fromNumber(16383&r).shiftLeft(49)),k.high=k.high.or(P.high.and(Gt.fromNumber(562949953421311)))),k.low=P.low,n&&(k.high=k.high.or(Gt.fromString("9223372036854775808")));var L=jt.alloc(16);return w=0,L[w++]=255&k.low.low,L[w++]=k.low.low>>8&255,L[w++]=k.low.low>>16&255,L[w++]=k.low.low>>24&255,L[w++]=255&k.low.high,L[w++]=k.low.high>>8&255,L[w++]=k.low.high>>16&255,L[w++]=k.low.high>>24&255,L[w++]=255&k.high.low,L[w++]=k.high.low>>8&255,L[w++]=k.high.low>>16&255,L[w++]=k.high.low>>24&255,L[w++]=255&k.high.high,L[w++]=k.high.high>>8&255,L[w++]=k.high.high>>16&255,L[w++]=k.high.high>>24&255,new t(L)},t.prototype.toString=function(){for(var t,e=0,r=new Array(36),n=0;n<r.length;n++)r[n]=0;var o,i,s,a=0,u=!1,c={parts:[0,0,0,0]},f=[];a=0;var h=this.bytes,l=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24,p=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24,d=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24,g=h[a++]|h[a++]<<8|h[a++]<<16|h[a++]<<24;a=0,{low:new Gt(l,p),high:new Gt(d,g)}.high.lessThan(Gt.ZERO)&&f.push("-");var y=g>>26&31;if(y>>3==3){if(30===y)return f.join("")+"Infinity";if(31===y)return"NaN";t=g>>15&16383,o=8+(g>>14&1)}else o=g>>14&7,t=g>>17&16383;var m=t-6176;if(c.parts[0]=(16383&g)+((15&o)<<14),c.parts[1]=d,c.parts[2]=p,c.parts[3]=l,0===c.parts[0]&&0===c.parts[1]&&0===c.parts[2]&&0===c.parts[3])u=!0;else for(s=3;s>=0;s--){var v=0,b=ae(c);if(c=b.quotient,v=b.rem.low)for(i=8;i>=0;i--)r[9*s+i]=v%10,v=Math.floor(v/10)}if(u)e=1,r[a]=0;else for(e=36;!r[a];)e-=1,a+=1;var w=e-1+m;if(w>=34||w<=-7||m>0){if(e>34)return f.push("0"),m>0?f.push("E+"+m):m<0&&f.push("E"+m),f.join("");f.push(""+r[a++]),(e-=1)&&f.push(".");for(n=0;n<e;n++)f.push(""+r[a++]);f.push("E"),w>0?f.push("+"+w):f.push(""+w)}else if(m>=0)for(n=0;n<e;n++)f.push(""+r[a++]);else{var _=e+m;if(_>0)for(n=0;n<_;n++)f.push(""+r[a++]);else f.push("0");for(f.push(".");_++<0;)f.push("0");for(n=0;n<e-Math.max(_-1,0);n++)f.push(""+r[a++])}return f.join("")},t.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},t.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},t.fromExtendedJSON=function(e){return t.fromString(e.$numberDecimal)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new Decimal128("'+this.toString()+'")'},t}();Object.defineProperty(ce.prototype,"_bsontype",{value:"Decimal128"});var fe=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toJSON=function(){return this.value},t.prototype.toString=function(t){return this.value.toString(t)},t.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-"+this.value.toFixed(1)}:(Number.isInteger(this.value)?(e=this.value.toFixed(1)).length>=13&&(e=this.value.toExponential(13).toUpperCase()):e=this.value.toString(),{$numberDouble:e});var e},t.fromExtendedJSON=function(e,r){var n=parseFloat(e.$numberDouble);return r&&r.relaxed?n:new t(n)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Double("+this.toExtendedJSON().$numberDouble+")"},t}();Object.defineProperty(fe.prototype,"_bsontype",{value:"Double"});var he=function(){function t(e){if(!(this instanceof t))return new t(e);e instanceof Number&&(e=e.valueOf()),this.value=+e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(t){return this.value.toString(t)},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},t.fromExtendedJSON=function(e,r){return r&&r.relaxed?parseInt(e.$numberInt,10):new t(e.$numberInt)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Int32("+this.valueOf()+")"},t}();Object.defineProperty(he.prototype,"_bsontype",{value:"Int32"});var le=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$maxKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MaxKey()"},t}();Object.defineProperty(le.prototype,"_bsontype",{value:"MaxKey"});var pe=function(){function t(){if(!(this instanceof t))return new t}return t.prototype.toExtendedJSON=function(){return{$minKey:1}},t.fromExtendedJSON=function(){return new t},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new MinKey()"},t}();Object.defineProperty(pe.prototype,"_bsontype",{value:"MinKey"});var de=new RegExp("^[0-9a-fA-F]{24}$"),ge=null,ye=Symbol("id"),me=function(){function t(e){if(!(this instanceof t))return new t(e);if(e instanceof t&&(this[ye]=e.id,this.__id=e.__id),"object"==typeof e&&e&&"id"in e&&("toHexString"in e&&"function"==typeof e.toHexString?this[ye]=jt.from(e.toHexString(),"hex"):this[ye]="string"==typeof e.id?jt.from(e.id):e.id),null!=e&&"number"!=typeof e||(this[ye]=t.generate("number"==typeof e?e:void 0),t.cacheHexString&&(this.__id=this.id.toString("hex"))),ArrayBuffer.isView(e)&&12===e.byteLength&&(this[ye]=Ut(e)),"string"==typeof e)if(12===e.length){var r=jt.from(e);12===r.byteLength&&(this[ye]=r)}else{if(24!==e.length||!de.test(e))throw new TypeError("Argument passed in must be a Buffer or string of 12 bytes or a string of 24 hex characters");this[ye]=jt.from(e,"hex")}t.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(t.prototype,"id",{get:function(){return this[ye]},set:function(e){this[ye]=e,t.cacheHexString&&(this.__id=e.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(){if(t.cacheHexString&&this.__id)return this.__id;var e=this.id.toString("hex");return t.cacheHexString&&!this.__id&&(this.__id=e),e},t.getInc=function(){return t.index=(t.index+1)%16777215},t.generate=function(e){"number"!=typeof e&&(e=~~(Date.now()/1e3));var r=t.getInc(),n=jt.alloc(12);return n.writeUInt32BE(e,0),null===ge&&(ge=Bt(5)),n[4]=ge[0],n[5]=ge[1],n[6]=ge[2],n[7]=ge[3],n[8]=ge[4],n[11]=255&r,n[10]=r>>8&255,n[9]=r>>16&255,n},t.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){return null!=e&&(e instanceof t?this.toString()===e.toString():"string"==typeof e&&t.isValid(e)&&12===e.length&&It(this.id)?e===jt.prototype.toString.call(this.id,"latin1"):"string"==typeof e&&t.isValid(e)&&24===e.length?e.toLowerCase()===this.toHexString():"string"==typeof e&&t.isValid(e)&&12===e.length?jt.from(e).equals(this.id):"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&e.toHexString()===this.toHexString())},t.prototype.getTimestamp=function(){var t=new Date,e=this.id.readUInt32BE(0);return t.setTime(1e3*Math.floor(e)),t},t.createPk=function(){return new t},t.createFromTime=function(e){var r=jt.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(e,0),new t(r)},t.createFromHexString=function(e){if(void 0===e||null!=e&&24!==e.length)throw new TypeError("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new t(jt.from(e,"hex"))},t.isValid=function(e){return null!=e&&("number"==typeof e||("string"==typeof e?12===e.length||24===e.length&&de.test(e):e instanceof t||(!(!It(e)||12!==e.length)||"object"==typeof e&&"toHexString"in e&&"function"==typeof e.toHexString&&("string"==typeof e.id?12===e.id.length:24===e.toHexString().length&&de.test(e.id.toString("hex"))))))},t.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},t.fromExtendedJSON=function(e){return new t(e.$oid)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new ObjectId("'+this.toHexString()+'")'},t.index=~~(16777215*Math.random()),t}();Object.defineProperty(me.prototype,"generate",{value:Tt((function(t){return me.generate(t)}),"Please use the static `ObjectId.generate(time)` instead")}),Object.defineProperty(me.prototype,"getInc",{value:Tt((function(){return me.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(me.prototype,"get_inc",{value:Tt((function(){return me.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(me,"get_inc",{value:Tt((function(){return me.getInc()}),"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(me.prototype,"_bsontype",{value:"ObjectID"});var ve=function(){function t(e,r){if(!(this instanceof t))return new t(e,r);this.pattern=e,this.options=(null!=r?r:"").split("").sort().join("");for(var n=0;n<this.options.length;n++)if("i"!==this.options[n]&&"m"!==this.options[n]&&"x"!==this.options[n]&&"l"!==this.options[n]&&"s"!==this.options[n]&&"u"!==this.options[n])throw new Error("The regular expression option ["+this.options[n]+"] is not supported")}return t.parseOptions=function(t){return t?t.split("").sort().join(""):""},t.prototype.toExtendedJSON=function(t){return(t=t||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},t.fromExtendedJSON=function(e){if("$regex"in e){if("string"==typeof e.$regex)return new t(e.$regex,t.parseOptions(e.$options));if("BSONRegExp"===e.$regex._bsontype)return e}if("$regularExpression"in e)return new t(e.$regularExpression.pattern,t.parseOptions(e.$regularExpression.options));throw new TypeError("Unexpected BSONRegExp EJSON object form: "+JSON.stringify(e))},t}();Object.defineProperty(ve.prototype,"_bsontype",{value:"BSONRegExp"});var be=function(){function t(e){if(!(this instanceof t))return new t(e);this.value=e}return t.prototype.valueOf=function(){return this.value},t.prototype.toString=function(){return this.value},t.prototype.inspect=function(){return'new BSONSymbol("'+this.value+'")'},t.prototype.toJSON=function(){return this.value},t.prototype.toExtendedJSON=function(){return{$symbol:this.value}},t.fromExtendedJSON=function(e){return new t(e.$symbol)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t}();Object.defineProperty(be.prototype,"_bsontype",{value:"Symbol"});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var we=function(t,e){return we=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},we(t,e)};var _e=function(t){function e(r,n){var o=this;return o instanceof e?(o=Gt.isLong(r)?t.call(this,r.low,r.high,!0)||this:Rt(r)&&void 0!==r.t&&void 0!==r.i?t.call(this,r.i,r.t,!0)||this:t.call(this,r,n,!0)||this,Object.defineProperty(o,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),o):new e(r,n)}return function(t,e){function r(){this.constructor=t}we(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.toJSON=function(){return{$timestamp:this.toString()}},e.fromInt=function(t){return new e(Gt.fromInt(t,!0))},e.fromNumber=function(t){return new e(Gt.fromNumber(t,!0))},e.fromBits=function(t,r){return new e(t,r)},e.fromString=function(t,r){return new e(Gt.fromString(t,!0,r))},e.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},e.fromExtendedJSON=function(t){return new e(t.$timestamp)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Timestamp({ t: "+this.getHighBits()+", i: "+this.getLowBits()+" })"},e.MAX_VALUE=Gt.MAX_UNSIGNED_VALUE,e}(Gt);var Ee=2147483647,xe=-2147483648,Se=0x8000000000000000,Oe=-0x8000000000000000,je={$oid:me,$binary:Ht,$uuid:Ht,$symbol:be,$numberInt:he,$numberDecimal:ce,$numberDouble:fe,$numberLong:Gt,$minKey:pe,$maxKey:le,$regex:ve,$regularExpression:ve,$timestamp:_e};function Ae(t,e){if(void 0===e&&(e={}),"number"==typeof t){if(e.relaxed||e.legacy)return t;if(Math.floor(t)===t){if(t>=xe&&t<=Ee)return new he(t);if(t>=Oe&&t<=Se)return Gt.fromNumber(t)}return new fe(t)}if(null==t||"object"!=typeof t)return t;if(t.$undefined)return null;for(var r=Object.keys(t).filter((function(e){return e.startsWith("$")&&null!=t[e]})),n=0;n<r.length;n++){var o=je[r[n]];if(o)return o.fromExtendedJSON(t,e)}if(null!=t.$date){var i=t.$date,s=new Date;return e.legacy?"number"==typeof i?s.setTime(i):"string"==typeof i&&s.setTime(Date.parse(i)):"string"==typeof i?s.setTime(Date.parse(i)):Gt.isLong(i)?s.setTime(i.toNumber()):"number"==typeof i&&e.relaxed&&s.setTime(i),s}if(null!=t.$code){var a=Object.assign({},t);return t.$scope&&(a.$scope=Ae(t.$scope)),Ft.fromExtendedJSON(t)}if(function(t){return Rt(t)&&null!=t.$id&&"string"==typeof t.$ref&&(null==t.$db||"string"==typeof t.$db)}(t)||t.$dbPointer){var u=t.$ref?t:t.$dbPointer;if(u instanceof qt)return u;var c=Object.keys(u).filter((function(t){return t.startsWith("$")})),f=!0;if(c.forEach((function(t){-1===["$ref","$id","$db"].indexOf(t)&&(f=!1)})),f)return qt.fromExtendedJSON(u)}return t}function $e(t){var e=t.toISOString();return 0!==t.getUTCMilliseconds()?e:e.slice(0,-5)+"Z"}function Ne(t,e){if(("object"==typeof t||"function"==typeof t)&&null!==t){var r=e.seenObjects.findIndex((function(e){return e.obj===t}));if(-1!==r){var n=e.seenObjects.map((function(t){return t.propertyName})),o=n.slice(0,r).map((function(t){return t+" -> "})).join(""),i=n[r],s=" -> "+n.slice(r+1,n.length-1).map((function(t){return t+" -> "})).join(""),a=n[n.length-1],u=" ".repeat(o.length+i.length/2),c="-".repeat(s.length+(i.length+a.length)/2-1);throw new TypeError("Converting circular structure to EJSON:\n    "+o+i+s+a+"\n    "+u+"\\"+c+"/")}e.seenObjects[e.seenObjects.length-1].obj=t}if(Array.isArray(t))return function(t,e){return t.map((function(t,r){e.seenObjects.push({propertyName:"index "+r,obj:null});try{return Ne(t,e)}finally{e.seenObjects.pop()}}))}(t,e);if(void 0===t)return null;if(t instanceof Date||function(t){return Rt(t)&&"[object Date]"===Object.prototype.toString.call(t)}(t)){var f=t.getTime(),h=f>-1&&f<2534023188e5;return e.legacy?e.relaxed&&h?{$date:t.getTime()}:{$date:$e(t)}:e.relaxed&&h?{$date:$e(t)}:{$date:{$numberLong:t.getTime().toString()}}}if(!("number"!=typeof t||e.relaxed&&isFinite(t))){if(Math.floor(t)===t){var l=t>=Oe&&t<=Se;if(t>=xe&&t<=Ee)return{$numberInt:t.toString()};if(l)return{$numberLong:t.toString()}}return{$numberDouble:t.toString()}}if(t instanceof RegExp||function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}(t)){var p=t.flags;if(void 0===p){var d=t.toString().match(/[gimuy]*$/);d&&(p=d[0])}return new ve(t.source,p).toExtendedJSON(e)}return null!=t&&"object"==typeof t?function(t,e){if(null==t||"object"!=typeof t)throw new Error("not an object instance");var r=t._bsontype;if(void 0===r){var n={};for(var o in t){e.seenObjects.push({propertyName:o,obj:null});try{n[o]=Ne(t[o],e)}finally{e.seenObjects.pop()}}return n}if(function(t){return Rt(t)&&Reflect.has(t,"_bsontype")&&"string"==typeof t._bsontype}(t)){var i=t;if("function"!=typeof i.toExtendedJSON){var s=Ie[t._bsontype];if(!s)throw new TypeError("Unrecognized or invalid _bsontype: "+t._bsontype);i=s(i)}return"Code"===r&&i.scope?i=new Ft(i.code,Ne(i.scope,e)):"DBRef"===r&&i.oid&&(i=new qt(Ne(i.collection,e),Ne(i.oid,e),Ne(i.db,e),Ne(i.fields,e))),i.toExtendedJSON(e)}throw new Error("_bsontype must be a string, but was: "+typeof r)}(t,e):t}var Be,Ie={Binary:function(t){return new Ht(t.value(),t.sub_type)},Code:function(t){return new Ft(t.code,t.scope)},DBRef:function(t){return new qt(t.collection||t.namespace,t.oid,t.db,t.fields)},Decimal128:function(t){return new ce(t.bytes)},Double:function(t){return new fe(t.value)},Int32:function(t){return new he(t.value)},Long:function(t){return Gt.fromBits(null!=t.low?t.low:t.low_,null!=t.low?t.high:t.high_,null!=t.low?t.unsigned:t.unsigned_)},MaxKey:function(){return new le},MinKey:function(){return new pe},ObjectID:function(t){return new me(t)},ObjectId:function(t){return new me(t)},BSONRegExp:function(t){return new ve(t.pattern,t.options)},Symbol:function(t){return new be(t.value)},Timestamp:function(t){return _e.fromBits(t.low,t.high)}};!function(t){function e(t,e){var r=Object.assign({},{relaxed:!0,legacy:!1},e);return"boolean"==typeof r.relaxed&&(r.strict=!r.relaxed),"boolean"==typeof r.strict&&(r.relaxed=!r.strict),JSON.parse(t,(function(t,e){return Ae(e,r)}))}function r(t,e,r,n){null!=r&&"object"==typeof r&&(n=r,r=0),null==e||"object"!=typeof e||Array.isArray(e)||(n=e,e=void 0,r=0);var o=Ne(t,Object.assign({relaxed:!0,legacy:!1},n,{seenObjects:[{propertyName:"(root)",obj:null}]}));return JSON.stringify(o,e,r)}t.parse=e,t.stringify=r,t.serialize=function(t,e){return e=e||{},JSON.parse(r(t,e))},t.deserialize=function(t,r){return r=r||{},e(JSON.stringify(t),r)}}(Be||(Be={})),$t().Map||function(){function t(t){void 0===t&&(t=[]),this._keys=[],this._values={};for(var e=0;e<t.length;e++)if(null!=t[e]){var r=t[e],n=r[0],o=r[1];this._keys.push(n),this._values[n]={v:o,i:this._keys.length-1}}}t.prototype.clear=function(){this._keys=[],this._values={}},t.prototype.delete=function(t){var e=this._values[t];return null!=e&&(delete this._values[t],this._keys.splice(e.i,1),!0)},t.prototype.entries=function(){var t=this,e=0;return{next:function(){var r=t._keys[e++];return{value:void 0!==r?[r,t._values[r].v]:void 0,done:void 0===r}}}},t.prototype.forEach=function(t,e){e=e||this;for(var r=0;r<this._keys.length;r++){var n=this._keys[r];t.call(e,this._values[n].v,n,e)}},t.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},t.prototype.has=function(t){return null!=this._values[t]},t.prototype.keys=function(){var t=this,e=0;return{next:function(){var r=t._keys[e++];return{value:void 0!==r?r:void 0,done:void 0===r}}}},t.prototype.set=function(t,e){return this._values[t]?(this._values[t].v=e,this):(this._keys.push(t),this._values[t]={v:e,i:this._keys.length-1},this)},t.prototype.values=function(){var t=this,e=0;return{next:function(){var r=t._keys[e++];return{value:void 0!==r?t._values[r].v:void 0,done:void 0===r}}}},Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0})}();var Re=Math.pow(2,53),Te=-Math.pow(2,53);Gt.fromNumber(Re),Gt.fromNumber(Te);jt.alloc(17825792);var Ue="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ce(t){var e={exports:{}};return t(e,e.exports),e.exports}var Me=Ce((function(t,e){var r;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.ChattyClientMessages||(e.ChattyClientMessages={}))[r.Syn=0]="Syn",r[r.Ack=1]="Ack",r[r.Message=2]="Message",r[r.MessageWithResponse=3]="MessageWithResponse",r[r.Response=4]="Response",r[r.ResponseError=5]="ResponseError"})),Pe=Ce((function(t,e){var r;Object.defineProperty(e,"__esModule",{value:!0}),(r=e.ChattyHostMessages||(e.ChattyHostMessages={}))[r.SynAck=0]="SynAck",r[r.Message=1]="Message",r[r.MessageWithResponse=2]="MessageWithResponse",r[r.Response=3]="Response",r[r.ResponseError=4]="ResponseError"})),ke=Ce((function(t,e){t.exports=function(){function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}var r=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,o=void 0,i=void 0,s=function(t,e){b[n]=t,b[n+1]=e,2===(n+=2)&&(i?i(w):E())};function a(t){i=t}function u(t){s=t}var c="undefined"!=typeof window?window:void 0,f=c||{},h=f.MutationObserver||f.WebKitMutationObserver,l="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){return function(){return process.nextTick(w)}}function g(){return void 0!==o?function(){o(w)}:v()}function y(){var t=0,e=new h(w),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function m(){var t=new MessageChannel;return t.port1.onmessage=w,function(){return t.port2.postMessage(0)}}function v(){var t=setTimeout;return function(){return t(w,1)}}var b=new Array(1e3);function w(){for(var t=0;t<n;t+=2)(0,b[t])(b[t+1]),b[t]=void 0,b[t+1]=void 0;n=0}function _(){try{var t=Function("return this")().require("vertx");return o=t.runOnLoop||t.runOnContext,g()}catch(t){return v()}}var E=void 0;function x(t,e){var r=this,n=new this.constructor(j);void 0===n[O]&&z(n);var o=r._state;if(o){var i=arguments[o-1];s((function(){return F(o,n,i,r._result)}))}else D(r,n,t,e);return n}function S(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(j);return M(r,t),r}E=l?d():h?y():p?m():void 0===c?_():v();var O=Math.random().toString(36).substring(2);function j(){}var A=void 0,$=1,N=2;function B(){return new TypeError("You cannot resolve a promise with itself")}function I(){return new TypeError("A promises callback cannot return that same promise.")}function R(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}function T(t,e,r){s((function(t){var n=!1,o=R(r,e,(function(r){n||(n=!0,e!==r?M(t,r):k(t,r))}),(function(e){n||(n=!0,L(t,e))}),"Settle: "+(t._label||" unknown promise"));!n&&o&&(n=!0,L(t,o))}),t)}function U(t,e){e._state===$?k(t,e._result):e._state===N?L(t,e._result):D(e,void 0,(function(e){return M(t,e)}),(function(e){return L(t,e)}))}function C(t,r,n){r.constructor===t.constructor&&n===x&&r.constructor.resolve===S?U(t,r):void 0===n?k(t,r):e(n)?T(t,r,n):k(t,r)}function M(e,r){if(e===r)L(e,B());else if(t(r)){var n=void 0;try{n=r.then}catch(t){return void L(e,t)}C(e,r,n)}else k(e,r)}function P(t){t._onerror&&t._onerror(t._result),H(t)}function k(t,e){t._state===A&&(t._result=e,t._state=$,0!==t._subscribers.length&&s(H,t))}function L(t,e){t._state===A&&(t._state=N,t._result=e,s(P,t))}function D(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+$]=r,o[i+N]=n,0===i&&t._state&&s(H,t)}function H(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)n=e[s],o=e[s+r],n?F(r,n,o,i):o(i);t._subscribers.length=0}}function F(t,r,n,o){var i=e(n),s=void 0,a=void 0,u=!0;if(i){try{s=n(o)}catch(t){u=!1,a=t}if(r===s)return void L(r,I())}else s=o;r._state!==A||(i&&u?M(r,s):!1===u?L(r,a):t===$?k(r,s):t===N&&L(r,s))}function q(t,e){try{e((function(e){M(t,e)}),(function(e){L(t,e)}))}catch(e){L(t,e)}}var J=0;function V(){return J++}function z(t){t[O]=J++,t._state=void 0,t._result=void 0,t._subscribers=[]}function W(){return new Error("Array Methods must be provided an Array")}var Z=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(j),this.promise[O]||z(this.promise),r(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&k(this.promise,this._result))):L(this.promise,W())}return t.prototype._enumerate=function(t){for(var e=0;this._state===A&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===S){var o=void 0,i=void 0,s=!1;try{o=t.then}catch(t){s=!0,i=t}if(o===x&&t._state!==A)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===tt){var a=new r(j);s?L(a,i):C(a,t,o),this._willSettleAt(a,e)}else this._willSettleAt(new r((function(e){return e(t)})),e)}else this._willSettleAt(n(t),e)},t.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===A&&(this._remaining--,t===N?L(n,r):this._result[e]=r),0===this._remaining&&k(n,this._result)},t.prototype._willSettleAt=function(t,e){var r=this;D(t,void 0,(function(t){return r._settledAt($,e,t)}),(function(t){return r._settledAt(N,e,t)}))},t}();function Y(t){return new Z(this,t).promise}function G(t){var e=this;return r(t)?new e((function(r,n){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(r,n)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))}function K(t){var e=new this(j);return L(e,t),e}function X(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Q(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var tt=function(){function t(e){this[O]=V(),this._result=this._state=void 0,this._subscribers=[],j!==e&&("function"!=typeof e&&X(),this instanceof t?q(this,e):Q())}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.finally=function(t){var r=this,n=r.constructor;return e(t)?r.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):r.then(t,t)},t}();function et(){var t=void 0;if(void 0!==Ue)t=Ue;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=tt}return tt.prototype.then=x,tt.all=Y,tt.race=G,tt.resolve=S,tt.reject=K,tt._setScheduler=a,tt._setAsap=u,tt._asap=s,tt.polyfill=et,tt.Promise=tt,tt}()}));ke.polyfill();var Le=1e3,De=60*Le,He=60*De,Fe=24*He,qe=365.25*Fe,Je=function(t,e){e=e||{};var r=typeof t;if("string"===r&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*qe;case"days":case"day":case"d":return r*Fe;case"hours":case"hour":case"hrs":case"hr":case"h":return r*He;case"minutes":case"minute":case"mins":case"min":case"m":return r*De;case"seconds":case"second":case"secs":case"sec":case"s":return r*Le;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(t);if("number"===r&&!1===isNaN(t))return e.long?function(t){return Ve(t,Fe,"day")||Ve(t,He,"hour")||Ve(t,De,"minute")||Ve(t,Le,"second")||t+" ms"}(t):function(t){if(t>=Fe)return Math.round(t/Fe)+"d";if(t>=He)return Math.round(t/He)+"h";if(t>=De)return Math.round(t/De)+"m";if(t>=Le)return Math.round(t/Le)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Ve(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var ze=Ce((function(t,e){var r;function n(t){function n(){if(n.enabled){var t=n,o=+new Date,i=o-(r||o);t.diff=i,t.prev=r,t.curr=o,r=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(r,n){if("%%"===r)return r;u++;var o=e.formatters[n];if("function"==typeof o){var i=s[u];r=o.call(t,i),s.splice(u,1),u--}return r})),e.formatArgs.call(t,s);var c=n.log||e.log||console.log.bind(console);c.apply(t,s)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var r,n=0;for(r in t)n=(n<<5)-n+t.charCodeAt(r),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),"function"==typeof e.init&&e.init(n),n}(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var r=("string"==typeof t?t:"").split(/[\s,]+/),n=r.length,o=0;o<n;o++)r[o]&&("-"===(t=r[o].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=Je,e.names=[],e.skips=[],e.formatters={}})),We=Ce((function(t,e){function r(){var t;try{t=e.storage.debug}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t}(e=t.exports=ze).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),!r)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))})),t.splice(i,0,n)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=r,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(r())})),Ze=Ce((function(t,e){var r,n=Ue&&Ue.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},o=Ue&&Ue.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))},i=Ue&&Ue.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Connecting=0]="Connecting",t[t.Syn=1]="Syn",t[t.Connected=2]="Connected"}(r=e.ChattyClientStates||(e.ChattyClientStates={}));var s=function(){function t(t){this._clientWindow=window,this._connection=null,this._hostWindow=this._clientWindow.parent,this._state=r.Connecting,this._sequence=0,this._receivers={},this._handlers=t.handlers,this._targetOrigin=t.targetOrigin,this._defaultTimeout=t.defaultTimeout,this._channel=new MessageChannel}return Object.defineProperty(t.prototype,"connection",{get:function(){return this._connection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isConnected",{get:function(){return this._state===r.Connected},enumerable:!0,configurable:!0}),t.prototype.connect=function(){return o(this,void 0,void 0,(function(){var e=this;return i(this,(function(n){return this._connection||(this._connection=new Promise((function(n,s){e._channel.port1.onmessage=function(s){switch(t._debug("received",s.data.action,s.data.data),s.data.action){case Pe.ChattyHostMessages.SynAck:e._state=r.Connected,e.sendMsg(Me.ChattyClientMessages.Ack),n({send:function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.sendMsg(Me.ChattyClientMessages.Message,{eventName:t,payload:r})},sendAndReceive:function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return o(e,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){return e=++this._sequence,this.sendMsg(Me.ChattyClientMessages.MessageWithResponse,{eventName:t,payload:r},e),[2,new Promise((function(t,r){var o;n._defaultTimeout>-1&&(o=setTimeout((function(){delete n._receivers[e],r(new Error("Timeout"))}),n._defaultTimeout)),n._receivers[e]={resolve:t,reject:r,timeoutId:o}}))]}))}))}});break;case Pe.ChattyHostMessages.Message:e._handlers[s.data.data.eventName]&&e._handlers[s.data.data.eventName].forEach((function(t){return t.apply(e,s.data.data.payload)}));break;case Pe.ChattyHostMessages.MessageWithResponse:var a=s.data.data,u=a.eventName,c=a.payload,f=a.sequence,h=[];e._handlers[u]&&(h=e._handlers[u].map((function(t){return t.apply(e,c)}))),Promise.all(h).then((function(t){e.sendMsg(Me.ChattyClientMessages.Response,{eventName:u,payload:t},f)})).catch((function(t){e.sendMsg(Me.ChattyClientMessages.ResponseError,{eventName:u,payload:t.toString()},f)}));break;case Pe.ChattyHostMessages.Response:var l=e._receivers[s.data.data.sequence];l&&(delete e._receivers[s.data.data.sequence],l.timeoutId&&clearTimeout(l.timeoutId),l.resolve(s.data.data.payload));break;case Pe.ChattyHostMessages.ResponseError:var p=e._receivers[s.data.data.sequence];p&&(delete e._receivers[s.data.data.sequence],p.timeoutId&&clearTimeout(p.timeoutId),p.reject("string"==typeof s.data.data.payload?new Error(s.data.data.payload):s.data.data.payload))}},e.initiateHandshake()}))),[2,this._connection]}))}))},t.prototype.initiateHandshake=function(){t._debug("connecting to",this._targetOrigin),this._hostWindow.postMessage({action:Me.ChattyClientMessages.Syn},this._targetOrigin,[this._channel.port2]),this._state=r.Syn},t.prototype.sendMsg=function(e,r,o){void 0===r&&(r={});var i=o?{sequence:o}:{},s=n(n({},r),i);t._debug("sending",e,s),this._channel.port1.postMessage({action:e,data:s})},t._debug=We("looker:chatty:client"),t}();e.ChattyClient=s})),Ye=function(){function t(){this._targetOrigin="*",this._handlers={},this._defaultTimeout=3e4}return Object.defineProperty(t.prototype,"targetOrigin",{get:function(){return this._targetOrigin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handlers",{get:function(){return this._handlers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultTimeout",{get:function(){return this._defaultTimeout},enumerable:!0,configurable:!0}),t.prototype.off=function(t,e){this._handlers[t]&&(this._handlers[t]=this._handlers[t].filter((function(t){return t!==e})))},t.prototype.on=function(t,e){return this._handlers[t]=this._handlers[t]||[],this._handlers[t].push(e),this},t.prototype.withDefaultTimeout=function(t){return this._defaultTimeout=t,this},t.prototype.withTargetOrigin=function(t){return this._targetOrigin=t,this},t.prototype.build=function(){return new Ze.ChattyClient(this)},t}(),Ge=Ye,Ke=Object.defineProperty({ChattyClientBuilder:Ge},"__esModule",{value:!0}),Xe=Ce((function(t,e){var r,n=Ue&&Ue.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)},o=Ue&&Ue.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))},i=Ue&&Ue.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Connecting=0]="Connecting",t[t.SynAck=1]="SynAck",t[t.Connected=2]="Connected"}(r=e.ChattyHostStates||(e.ChattyHostStates={}));var s=function(){function t(t){var e=this;this._hostWindow=window,this._connection=null,this._state=r.Connecting,this._sequence=0,this._receivers={},this.iframe=document.createElement("iframe"),t.sandboxAttrs.forEach((function(t){return e.iframe.sandbox.add(t)})),"allow"in this.iframe&&(this.iframe.allow=t.allowAttrs.join("; ")),this.iframe.frameBorder=t.getFrameBorder(),t.url?this.iframe.src=t.url:t.source?this.iframe.srcdoc=t.source:console.warn("url or source required to initialize Chatty host correctly"),this._appendTo=t.el,this._handlers=t.handlers,this._port=null,this._targetOrigin=t.targetOrigin,this._defaultTimeout=t.defaultTimeout}return Object.defineProperty(t.prototype,"connection",{get:function(){return this._connection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isConnected",{get:function(){return this._state===r.Connected},enumerable:!0,configurable:!0}),t.prototype.connect=function(){return o(this,void 0,void 0,(function(){var e,n=this;return i(this,(function(s){return this._connection?[2,this._connection]:(e=function(){return o(n,void 0,void 0,(function(){var e=this;return i(this,(function(n){return[2,new Promise((function(n,s){var a=function(s){switch(t._debug("port received",s.data.action,s.data.data),s.data.action){case Me.ChattyClientMessages.Ack:e._state=r.Connected,n({send:function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];e.sendMsg(Pe.ChattyHostMessages.Message,{eventName:t,payload:r})},sendAndReceive:function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return o(e,void 0,void 0,(function(){var e,n=this;return i(this,(function(o){return e=++this._sequence,this.sendMsg(Pe.ChattyHostMessages.MessageWithResponse,{eventName:t,payload:r},e),[2,new Promise((function(t,r){var o;n._defaultTimeout>-1&&(o=setTimeout((function(){delete n._receivers[e],r(new Error("Timeout"))}),n._defaultTimeout)),n._receivers[e]={resolve:t,reject:r,timeoutId:o}}))]}))}))}});break;case Me.ChattyClientMessages.Message:e._handlers[s.data.data.eventName]&&e._handlers[s.data.data.eventName].forEach((function(t){return t.apply(e,s.data.data.payload)}));break;case Me.ChattyClientMessages.MessageWithResponse:var a=s.data.data,u=a.eventName,c=a.payload,f=a.sequence,h=[];e._handlers[u]&&(h=e._handlers[u].map((function(t){return t.apply(e,c)}))),Promise.all(h).then((function(t){e.sendMsg(Pe.ChattyHostMessages.Response,{eventName:u,payload:t},f)})).catch((function(t){e.sendMsg(Pe.ChattyHostMessages.ResponseError,{eventName:u,payload:t.toString()},f)}));break;case Me.ChattyClientMessages.Response:(l=e._receivers[s.data.data.sequence])&&(delete e._receivers[s.data.data.sequence],l.timeoutId&&clearTimeout(l.timeoutId),l.resolve(s.data.data.payload));break;case Me.ChattyClientMessages.ResponseError:var l;(l=e._receivers[s.data.data.sequence])&&(delete e._receivers[s.data.data.sequence],l.timeoutId&&clearTimeout(l.timeoutId),l.reject("string"==typeof s.data.data.payload?new Error(s.data.data.payload):s.data.data.payload))}};e._hostWindow.addEventListener("message",(function(n){if(e.isValidMsg(n)){if(t._debug("window received",n.data.action,n.data.data),n.data.action===Me.ChattyClientMessages.Syn){if(e._port){if(!(e._targetOrigin&&"*"===e._targetOrigin||e._targetOrigin===n.origin))return void t._debug("rejected new connection from",n.origin);t._debug("reconnecting to",n.origin),e._port.close()}e._port=n.ports[0],e._port.onmessage=a,e.sendMsg(Pe.ChattyHostMessages.SynAck),e._state=r.SynAck}}else t._debug("window received invalid",n)}))}))]}))}))},this._appendTo.appendChild(this.iframe),[2,this._connection=e()])}))}))},t.prototype.sendMsg=function(e,r,o){void 0===r&&(r={});var i=o?{sequence:o}:{},s=n(n({},r),i);t._debug("sending",e,s),this._port.postMessage({action:e,data:s})},t.prototype.isValidMsg=function(t){return t.source===this.iframe.contentWindow&&(!this._targetOrigin||"*"===this._targetOrigin||this._targetOrigin===t.origin)},t._debug=We("looker:chatty:host"),t}();e.ChattyHost=s})),Qe=function(){function t(t,e){this._url=t,this._source=e,this._appendTo=null,this._handlers={},this._sandboxAttrs=[],this._allowAttrs=[],this._frameBorder="0",this._targetOrigin=null,this._defaultTimeout=3e4}return Object.defineProperty(t.prototype,"el",{get:function(){return this._appendTo||document.body},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"handlers",{get:function(){return this._handlers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sandboxAttrs",{get:function(){return this._sandboxAttrs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowAttrs",{get:function(){return this._allowAttrs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetOrigin",{get:function(){return this._targetOrigin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultTimeout",{get:function(){return this._defaultTimeout},enumerable:!0,configurable:!0}),t.prototype.appendTo=function(t){return this._appendTo=t,this},t.prototype.off=function(t,e){this._handlers[t]&&(this._handlers[t]=this._handlers[t].filter((function(t){return t!==e})))},t.prototype.on=function(t,e){return this._handlers[t]=this._handlers[t]||[],this._handlers[t].push(e),this},t.prototype.withDefaultTimeout=function(t){return this._defaultTimeout=t,this},t.prototype.getFrameBorder=function(){return this._frameBorder},t.prototype.frameBorder=function(t){return this._frameBorder=t,this},t.prototype.sandbox=function(t){return this.withSandboxAttribute(t),this},t.prototype.withSandboxAttribute=function(t){return this._sandboxAttrs.push(t),this},t.prototype.withAllowAttribute=function(t){return this._allowAttrs.push(t),this},t.prototype.withTargetOrigin=function(t){return this._targetOrigin=t,this},t.prototype.build=function(){return new Xe.ChattyHost(this)},t}(),tr=Qe,er=Object.defineProperty({ChattyHostBuilder:tr},"__esModule",{value:!0});Ke.ChattyClientBuilder,er.ChattyHostBuilder,Ze.ChattyClient,Xe.ChattyHost;var rr=function(){function t(){}return t.createHost=function(t){return new er.ChattyHostBuilder(t)},t.createHostFromSource=function(t){return new er.ChattyHostBuilder(void 0,t)},t.createClient=function(){return new Ke.ChattyClientBuilder},t}();var nr=function(){this.__data__=[],this.size=0};var or=function(t,e){return t===e||t!=t&&e!=e};var ir=function(t,e){for(var r=t.length;r--;)if(or(t[r][0],e))return r;return-1},sr=Array.prototype.splice;var ar=function(t){var e=this.__data__,r=ir(e,t);return!(r<0)&&(r==e.length-1?e.pop():sr.call(e,r,1),--this.size,!0)};var ur=function(t){var e=this.__data__,r=ir(e,t);return r<0?void 0:e[r][1]};var cr=function(t){return ir(this.__data__,t)>-1};var fr=function(t,e){var r=this.__data__,n=ir(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function hr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}hr.prototype.clear=nr,hr.prototype.delete=ar,hr.prototype.get=ur,hr.prototype.has=cr,hr.prototype.set=fr;var lr=hr;var pr=function(){this.__data__=new lr,this.size=0};var dr=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var gr=function(t){return this.__data__.get(t)};var yr=function(t){return this.__data__.has(t)},mr="object"==typeof Ue&&Ue&&Ue.Object===Object&&Ue,vr="object"==typeof self&&self&&self.Object===Object&&self,br=mr||vr||Function("return this")(),wr=br.Symbol,_r=Object.prototype,Er=_r.hasOwnProperty,xr=_r.toString,Sr=wr?wr.toStringTag:void 0;var Or=function(t){var e=Er.call(t,Sr),r=t[Sr];try{t[Sr]=void 0;var n=!0}catch(t){}var o=xr.call(t);return n&&(e?t[Sr]=r:delete t[Sr]),o},jr=Object.prototype.toString;var Ar=function(t){return jr.call(t)},$r=wr?wr.toStringTag:void 0;var Nr=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":$r&&$r in Object(t)?Or(t):Ar(t)};var Br=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var Ir,Rr=function(t){if(!Br(t))return!1;var e=Nr(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Tr=br["__core-js_shared__"],Ur=(Ir=/[^.]+$/.exec(Tr&&Tr.keys&&Tr.keys.IE_PROTO||""))?"Symbol(src)_1."+Ir:"";var Cr=function(t){return!!Ur&&Ur in t},Mr=Function.prototype.toString;var Pr=function(t){if(null!=t){try{return Mr.call(t)}catch(t){}try{return t+""}catch(t){}}return""},kr=/^\[object .+?Constructor\]$/,Lr=Function.prototype,Dr=Object.prototype,Hr=Lr.toString,Fr=Dr.hasOwnProperty,qr=RegExp("^"+Hr.call(Fr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Jr=function(t){return!(!Br(t)||Cr(t))&&(Rr(t)?qr:kr).test(Pr(t))};var Vr=function(t,e){return null==t?void 0:t[e]};var zr=function(t,e){var r=Vr(t,e);return Jr(r)?r:void 0},Wr=zr(br,"Map"),Zr=zr(Object,"create");var Yr=function(){this.__data__=Zr?Zr(null):{},this.size=0};var Gr=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Kr=Object.prototype.hasOwnProperty;var Xr=function(t){var e=this.__data__;if(Zr){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return Kr.call(e,t)?e[t]:void 0},Qr=Object.prototype.hasOwnProperty;var tn=function(t){var e=this.__data__;return Zr?void 0!==e[t]:Qr.call(e,t)};var en=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Zr&&void 0===e?"__lodash_hash_undefined__":e,this};function rn(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}rn.prototype.clear=Yr,rn.prototype.delete=Gr,rn.prototype.get=Xr,rn.prototype.has=tn,rn.prototype.set=en;var nn=rn;var on=function(){this.size=0,this.__data__={hash:new nn,map:new(Wr||lr),string:new nn}};var sn=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var an=function(t,e){var r=t.__data__;return sn(e)?r["string"==typeof e?"string":"hash"]:r.map};var un=function(t){var e=an(this,t).delete(t);return this.size-=e?1:0,e};var cn=function(t){return an(this,t).get(t)};var fn=function(t){return an(this,t).has(t)};var hn=function(t,e){var r=an(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function ln(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ln.prototype.clear=on,ln.prototype.delete=un,ln.prototype.get=cn,ln.prototype.has=fn,ln.prototype.set=hn;var pn=ln;var dn=function(t,e){var r=this.__data__;if(r instanceof lr){var n=r.__data__;if(!Wr||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new pn(n)}return r.set(t,e),this.size=r.size,this};function gn(t){var e=this.__data__=new lr(t);this.size=e.size}gn.prototype.clear=pr,gn.prototype.delete=dr,gn.prototype.get=gr,gn.prototype.has=yr,gn.prototype.set=dn;var yn=gn;var mn=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var vn=function(t){return this.__data__.has(t)};function bn(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new pn;++e<r;)this.add(t[e])}bn.prototype.add=bn.prototype.push=mn,bn.prototype.has=vn;var wn=bn;var _n=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1};var En=function(t,e){return t.has(e)};var xn=function(t,e,r,n,o,i){var s=1&r,a=t.length,u=e.length;if(a!=u&&!(s&&u>a))return!1;var c=i.get(t),f=i.get(e);if(c&&f)return c==e&&f==t;var h=-1,l=!0,p=2&r?new wn:void 0;for(i.set(t,e),i.set(e,t);++h<a;){var d=t[h],g=e[h];if(n)var y=s?n(g,d,h,e,t,i):n(d,g,h,t,e,i);if(void 0!==y){if(y)continue;l=!1;break}if(p){if(!_n(e,(function(t,e){if(!En(p,e)&&(d===t||o(d,t,r,n,i)))return p.push(e)}))){l=!1;break}}else if(d!==g&&!o(d,g,r,n,i)){l=!1;break}}return i.delete(t),i.delete(e),l},Sn=br.Uint8Array;var On=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r};var jn=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r},An=wr?wr.prototype:void 0,$n=An?An.valueOf:void 0;var Nn=function(t,e,r,n,o,i,s){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new Sn(t),new Sn(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return or(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=On;case"[object Set]":var u=1&n;if(a||(a=jn),t.size!=e.size&&!u)return!1;var c=s.get(t);if(c)return c==e;n|=2,s.set(t,e);var f=xn(a(t),a(e),n,o,i,s);return s.delete(t),f;case"[object Symbol]":if($n)return $n.call(t)==$n.call(e)}return!1};var Bn=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},In=Array.isArray;var Rn=function(t,e,r){var n=e(t);return In(t)?n:Bn(n,r(t))};var Tn=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var s=t[r];e(s,r,t)&&(i[o++]=s)}return i};var Un=function(){return[]},Cn=Object.prototype.propertyIsEnumerable,Mn=Object.getOwnPropertySymbols,Pn=Mn?function(t){return null==t?[]:(t=Object(t),Tn(Mn(t),(function(e){return Cn.call(t,e)})))}:Un;var kn=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Ln=function(t){return null!=t&&"object"==typeof t};var Dn=function(t){return Ln(t)&&"[object Arguments]"==Nr(t)},Hn=Object.prototype,Fn=Hn.hasOwnProperty,qn=Hn.propertyIsEnumerable,Jn=Dn(function(){return arguments}())?Dn:function(t){return Ln(t)&&Fn.call(t,"callee")&&!qn.call(t,"callee")},Vn=Jn;var zn=function(){return!1},Wn=Ce((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r?br.Buffer:void 0,i=(o?o.isBuffer:void 0)||zn;t.exports=i})),Zn=/^(?:0|[1-9]\d*)$/;var Yn=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Zn.test(t))&&t>-1&&t%1==0&&t<e};var Gn=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Kn={};Kn["[object Float32Array]"]=Kn["[object Float64Array]"]=Kn["[object Int8Array]"]=Kn["[object Int16Array]"]=Kn["[object Int32Array]"]=Kn["[object Uint8Array]"]=Kn["[object Uint8ClampedArray]"]=Kn["[object Uint16Array]"]=Kn["[object Uint32Array]"]=!0,Kn["[object Arguments]"]=Kn["[object Array]"]=Kn["[object ArrayBuffer]"]=Kn["[object Boolean]"]=Kn["[object DataView]"]=Kn["[object Date]"]=Kn["[object Error]"]=Kn["[object Function]"]=Kn["[object Map]"]=Kn["[object Number]"]=Kn["[object Object]"]=Kn["[object RegExp]"]=Kn["[object Set]"]=Kn["[object String]"]=Kn["[object WeakMap]"]=!1;var Xn=function(t){return Ln(t)&&Gn(t.length)&&!!Kn[Nr(t)]};var Qn=function(t){return function(e){return t(e)}},to=Ce((function(t,e){var r=e&&!e.nodeType&&e,n=r&&t&&!t.nodeType&&t,o=n&&n.exports===r&&mr.process,i=function(){try{var t=n&&n.require&&n.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i})),eo=to&&to.isTypedArray,ro=eo?Qn(eo):Xn,no=Object.prototype.hasOwnProperty;var oo=function(t,e){var r=In(t),n=!r&&Vn(t),o=!r&&!n&&Wn(t),i=!r&&!n&&!o&&ro(t),s=r||n||o||i,a=s?kn(t.length,String):[],u=a.length;for(var c in t)!e&&!no.call(t,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Yn(c,u))||a.push(c);return a},io=Object.prototype;var so=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||io)};var ao=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),uo=Object.prototype.hasOwnProperty;var co=function(t){if(!so(t))return ao(t);var e=[];for(var r in Object(t))uo.call(t,r)&&"constructor"!=r&&e.push(r);return e};var fo=function(t){return null!=t&&Gn(t.length)&&!Rr(t)};var ho=function(t){return fo(t)?oo(t):co(t)};var lo=function(t){return Rn(t,ho,Pn)},po=Object.prototype.hasOwnProperty;var go=function(t,e,r,n,o,i){var s=1&r,a=lo(t),u=a.length;if(u!=lo(e).length&&!s)return!1;for(var c=u;c--;){var f=a[c];if(!(s?f in e:po.call(e,f)))return!1}var h=i.get(t),l=i.get(e);if(h&&l)return h==e&&l==t;var p=!0;i.set(t,e),i.set(e,t);for(var d=s;++c<u;){var g=t[f=a[c]],y=e[f];if(n)var m=s?n(y,g,f,e,t,i):n(g,y,f,t,e,i);if(!(void 0===m?g===y||o(g,y,r,n,i):m)){p=!1;break}d||(d="constructor"==f)}if(p&&!d){var v=t.constructor,b=e.constructor;v==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof b&&b instanceof b||(p=!1)}return i.delete(t),i.delete(e),p},yo=zr(br,"DataView"),mo=zr(br,"Promise"),vo=zr(br,"Set"),bo=zr(br,"WeakMap"),wo="[object Map]",_o="[object Promise]",Eo="[object Set]",xo="[object WeakMap]",So="[object DataView]",Oo=Pr(yo),jo=Pr(Wr),Ao=Pr(mo),$o=Pr(vo),No=Pr(bo),Bo=Nr;(yo&&Bo(new yo(new ArrayBuffer(1)))!=So||Wr&&Bo(new Wr)!=wo||mo&&Bo(mo.resolve())!=_o||vo&&Bo(new vo)!=Eo||bo&&Bo(new bo)!=xo)&&(Bo=function(t){var e=Nr(t),r="[object Object]"==e?t.constructor:void 0,n=r?Pr(r):"";if(n)switch(n){case Oo:return So;case jo:return wo;case Ao:return _o;case $o:return Eo;case No:return xo}return e});var Io=Bo,Ro="[object Arguments]",To="[object Array]",Uo="[object Object]",Co=Object.prototype.hasOwnProperty;var Mo=function(t,e,r,n,o,i){var s=In(t),a=In(e),u=s?To:Io(t),c=a?To:Io(e),f=(u=u==Ro?Uo:u)==Uo,h=(c=c==Ro?Uo:c)==Uo,l=u==c;if(l&&Wn(t)){if(!Wn(e))return!1;s=!0,f=!1}if(l&&!f)return i||(i=new yn),s||ro(t)?xn(t,e,r,n,o,i):Nn(t,e,u,r,n,o,i);if(!(1&r)){var p=f&&Co.call(t,"__wrapped__"),d=h&&Co.call(e,"__wrapped__");if(p||d){var g=p?t.value():t,y=d?e.value():e;return i||(i=new yn),o(g,y,r,n,i)}}return!!l&&(i||(i=new yn),go(t,e,r,n,o,i))};var Po=function t(e,r,n,o,i){return e===r||(null==e||null==r||!Ln(e)&&!Ln(r)?e!=e&&r!=r:Mo(e,r,n,o,t,i))};var ko=function(t,e){return Po(t,e)},Lo=Object.prototype.hasOwnProperty;var Do=function(t){if(null==t)return!0;if(fo(t)&&(In(t)||"string"==typeof t||"function"==typeof t.splice||Wn(t)||ro(t)||Vn(t)))return!t.length;var e=Io(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(so(t))return!co(t).length;for(var r in t)if(Lo.call(t,r))return!1;return!0};let Ho,Fo;!function(t){t.DARK="dark",t.LIGHT="light"}(Ho||(Ho={})),function(t){t.FIXED="fixed",t.SCALE="scale"}(Fo||(Fo={}));const qo=t=>{const{background:e,baseUrl:r,autoRefresh:n,maxDataAge:o,width:i,height:s,theme:a,showAttribution:u,getUserToken:c}=t;if("string"!=typeof r||0===r.length)throw new Error("Base URL must be a valid URL");if(void 0!==e&&"string"!=typeof e)throw new Error("background must be a string if specified");if(void 0!==n&&"boolean"!=typeof n)throw new Error("autoRefresh must be a boolean if specified");if(void 0!==o&&"number"!=typeof o)throw new Error("maxDataAge must be a number if specified");if(void 0!==i&&!["number","string"].includes(typeof i))throw new Error("Width must be a string or number if specified");if(void 0!==s&&!["number","string"].includes(typeof s))throw new Error("Height must be a string or number if specified");if(void 0!==a&&"string"!=typeof a)throw new Error("Theme must be a string if specified");if(void 0!==u&&"boolean"!=typeof u)throw new Error("Attribution must be a boolean value if specified");if(void 0!==c&&"function"!=typeof c)throw new Error("getUserToken must be a function");return{background:e,baseUrl:r,autoRefresh:n,maxDataAge:o,width:i,height:s,theme:a,showAttribution:u,getUserToken:c}},Jo=(t,e)=>[t.pathname,"/"===t.pathname.slice(-1)?"":"/",e].join(""),Vo=t=>"string"==typeof t?t:"number"==typeof t?`${t}px`:null;function zo(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class Wo{constructor(){zo(this,"iframe",void 0),zo(this,"connection",void 0),zo(this,"name",void 0),zo(this,"ERRORS",void 0),zo(this,"COLOUR",void 0),zo(this,"options",void 0)}async render(t){if(this.iframe)throw new Error(this.ERRORS.IFRAME);const e=this._configureEmbedRoot(function(t,e={},r=[]){const n=document.createElement(t);for(const[t,r]of Object.entries(e))"style"===t?Object.assign(n.style,e.style):n.setAttribute(t,r);for(const t of Array.isArray(r)?r:[r])n.append(t);return n}("div",{style:{position:"relative",overflow:"hidden",minHeight:Boolean(this.options.height)?0:"15px",width:Vo(this.options.width)||"100%",height:Vo(this.options.height)||"100%"}})),r=this._configureHost(rr.createHost(this.getEmbedUrl()).withSandboxAttribute("allow-scripts").withSandboxAttribute("allow-same-origin").withSandboxAttribute("allow-popups").withSandboxAttribute("allow-popups-to-escape-sandbox").appendTo(e)).build();for(r.iframe.setAttribute("aria-label",this.name),Object.assign(r.iframe.style,{position:"absolute",top:0,left:0,border:0,width:"100%",height:"100%"});t.firstChild;)t.removeChild(t.firstChild);t.appendChild(e),this.connection=await r.connect(),this.iframe=r.iframe,this._setBackground(this.options.background,this.options.theme),await this._retrieveAndSetToken(),await this._send("ready")}async isAutoRefresh(){const[t]=await this._send("get","autoRefresh");return"number"==typeof t||"boolean"==typeof t?Boolean(t):Promise.reject("unexpected response received from iframe")}async setAutoRefresh(t){if("boolean"!=typeof t)return Promise.reject("autoRefresh property value should be a boolean");await this._send("set","autoRefresh",t)}async getMaxDataAge(){const[t]=await this._send("get","maxDataAge");return"number"==typeof t?t:Promise.reject("unexpected response received from iframe")}async setMaxDataAge(t){if("number"!=typeof t)return Promise.reject("maxDataAge property value should be a number");await this._send("set","maxDataAge",t)}async setTheme(t){if("string"!=typeof t)return Promise.reject("theme property value should be a string");const e=Object.values(Ho).includes(t)?t:Ho.LIGHT;await this._send("set","theme",e),this._setBackground(this.options.background,e)}async getTheme(){const[t]=await this._send("get","theme");return"string"==typeof t?t:Promise.reject("unexpected response received from iframe")}_configureHost(t){return t.on("refreshToken",(()=>this._retrieveAndSetToken()))}_configureEmbedRoot(t){return t}_setBackground(t,e){this.iframe.style.backgroundColor=((t,e,r,n)=>"string"==typeof t&&t.length>0?t:"dark"===e?n:r)(t,e,this.COLOUR.LIGHT,this.COLOUR.DARK)}async _retrieveAndSetToken(){if(this.options.getUserToken){const t=await this.options.getUserToken();await this._send("set","token",t)}}_send(t,...e){return this.connection?this.connection.sendAndReceive(t,...e):Promise.reject(this.ERRORS.SEND)}}let Zo=Date.now();function Yo(t){var e;return e=class extends t{constructor(...t){var e,r,n;super(...t),n={click:{}},(r="_eventHandlers")in(e=this)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}_handleEvent(t,e,r){const n=this._eventHandlers[t];for(const i of r)try{var o;null===(o=n[i])||void 0===o||o.handle(e)}catch(e){console.warn(`Error calling handler for event [${t}]: ${e}`)}}addEventListener(t,e,r){var n;const o=this._eventHandlers[t];if(!o)throw new Error(`Not supported event: ${t}`);const i={handle:e,options:{includes:null==r?void 0:r.includes}};if(null!==(n=i.options.includes)&&void 0!==n&&n.every((t=>Do(t)))&&console.warn("Empty includes filters out all events. Event handler will never be called. Is this intended?"),!Object.keys(o).some((t=>ko(o[t],i)))){const e=(++Zo).toString(36);return o[e]=i,this._send("eventHandler",t,{handlerId:e,options:i.options})}return Promise.resolve()}removeEventListener(t,e,r){const n=this._eventHandlers[t];if(!n)throw new Error(`Not supported event: ${t}`);const o={handle:e,options:{includes:null==r?void 0:r.includes}},i=Object.keys(n).find((t=>ko(n[t],o)));return i?(delete n[i],this._send("eventHandler",t,{handlerId:i})):Promise.resolve()}},e}function Go(t){return class extends t{async refresh(){await this._send("refresh")}}}function Ko(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class Xo extends Wo{constructor(t){super(),Ko(this,"name","Embedded Chart"),Ko(this,"ERRORS",{SEND:"Chart has not been rendered. Ensure that you wait for the promise returned by `chart.render()` before trying to manipulate a chart.",IFRAME:"A chart can only be rendered into a container once"}),Ko(this,"COLOUR",{LIGHT:"#FFFFFF",DARK:"#21313C"}),Ko(this,"options",void 0),this.options=(t=>{if("object"!=typeof t||null===t)throw new Error("Options argument must be an object");const e=qo(t),{chartId:r,filter:n,refreshInterval:o}=t;if("string"!=typeof r||0===r.length)throw new Error("Chart ID must be specified");if(void 0!==n&&(!n||"object"!=typeof n))throw new Error("Filter must be an object if specified");if(void 0!==o&&"number"!=typeof o)throw new Error("refreshInterval interval must be a number if specified");return{...e,chartId:r,filter:n,refreshInterval:o}})(t)}getEmbedUrl(){return(t=>{try{const e=new URL(t.baseUrl);return e.pathname=Jo(e,"embed/charts"),e.search=`id=${t.chartId}&sdk=2`,!1===t.autoRefresh?e.search+="&autorefresh=false":void 0===t.autoRefresh&&(e.search+=t.refreshInterval?`&autorefresh=${t.refreshInterval}`:""),void 0!==t.maxDataAge&&(e.search+=`&maxDataAge=${t.maxDataAge}`),t.filter&&(e.search+=`&filter=${encodeURIComponent(Be.stringify(t.filter,{relaxed:!1}))}`),t.theme&&(e.search+=`&theme=${t.theme}`),!1===t.showAttribution&&(e.search+="&attribution=false"),e.toString()}catch(t){throw new Error("Base URL must be a valid URL")}})(this.options)}}class Qo extends(Go(Yo(Xo))){async getRefreshInterval(){const[t]=await this._send("get","autorefresh");return console.warn("The 'getRefreshInterval' method is deprecated. Please use the 'autoRefresh' option with the 'maxDataAge' option to configure how often the chart refreshes."),"number"==typeof t?t:Promise.reject("unexpected response received from iframe")}async setRefreshInterval(t){if("number"!=typeof t)return Promise.reject("refreshInterval property value should be a number");console.warn("The 'setRefreshInterval' method is deprecated. Please use the 'autoRefresh' option with the 'maxDataAge' option to configure how often the chart refreshes."),await this._send("set","autorefresh",t)}async getFilter(){const[t]=await this._send("get","filter");return"object"==typeof t&&null!==t?t:Promise.reject("unexpected response received from iframe")}async setFilter(t){if("object"!=typeof t||null===t||Array.isArray(t))return Promise.reject("filter property value should be an object");await this._send("set","filter",Be.stringify(t,{relaxed:!1}))}async getHighlight(){const[t]=await this._send("get","highlight");return"object"==typeof t&&null!==t?t:Promise.reject("unexpected response received from iframe")}async setHighlight(t){if("object"!=typeof t||null===t||Array.isArray(t))return Promise.reject("highlight property value should be an object");await this._send("set","highlight",Be.stringify(t,{relaxed:!1}))}_configureHost(t){return super._configureHost(t).on("event",this._handleEvent.bind(this))}async getData(){const[t]=await this._send("get","data");return"object"==typeof t&&null!==t?t:Promise.reject("unexpected response received from iframe")}}class ti{constructor(t,e){this.chartId=t,this.dashboard=e}_send(t,...e){return this.dashboard._send(t,...e,this.chartId)}}class ei extends(Go(Yo(ti))){}function ri(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class ni extends Wo{constructor(t){super(),ri(this,"name","Embedded Dashboard"),ri(this,"ERRORS",{SEND:"Dashboard has not been rendered. Ensure that you wait for the promise returned by `dashboard.render()` before trying to manipulate a dashboard.",IFRAME:"A dashboard can only be rendered into a container once"}),ri(this,"COLOUR",{LIGHT:"#F1F5F4",DARK:"#12212C"}),ri(this,"options",void 0),this.options=(t=>{if("object"!=typeof t||null===t)throw new Error("Options argument must be an object");const e=qo(t),{dashboardId:r,chartsBackground:n,widthMode:o,heightMode:i,showTitleAndDesc:s}=t;if("string"!=typeof r||0===r.length)throw new Error("dashboardId must be specified");if(void 0!==n&&"string"!=typeof n)throw new Error("chartsBackground must be a string if specified");if(void 0!==o&&"string"!=typeof o)throw new Error("widthMode must be a string if specified");if(void 0!==o&&o!==Fo.FIXED&&o!==Fo.SCALE)throw new Error(`widthMode must be "${Fo.FIXED}" or "${Fo.SCALE}"`);if(void 0!==i&&"string"!=typeof i)throw new Error("heightMode must be a string if specified");if(void 0!==i&&i!==Fo.FIXED&&i!==Fo.SCALE)throw new Error(`heightMode must be "${Fo.FIXED}" or "${Fo.SCALE}"`);if(void 0!==s&&"boolean"!=typeof s)throw new Error("showTitleAndDesc must be a boolean value if specified");return{...e,dashboardId:r,chartsBackground:n,widthMode:o,heightMode:i,showTitleAndDesc:s}})(t)}getEmbedUrl(){return(t=>{try{const e=new URL(t.baseUrl);return e.pathname=Jo(e,"embed/dashboards"),e.search=`id=${t.dashboardId}&sdk=1`,!1===t.autoRefresh&&(e.search+="&autoRefresh=false"),void 0!==t.maxDataAge&&(e.search+=`&maxDataAge=${t.maxDataAge}`),!0===t.showTitleAndDesc&&(e.search+="&showTitleAndDesc=true"),t.widthMode&&(e.search+=`&scalingWidth=${t.widthMode}`),t.heightMode&&(e.search+=`&scalingHeight=${t.heightMode}`),t.theme&&(e.search+=`&theme=${t.theme}`),t.chartsBackground&&(e.search+=`&chartsBackground=${t.chartsBackground}`),!1===t.showAttribution&&(e.search+="&attribution=false"),e.toString()}catch(t){throw new Error("Base URL must be a valid URL")}})(this.options)}}class oi extends(Go(ni)){constructor(...t){super(...t),ri(this,"charts",{})}async getChartsBackground(){const[t]=await this._send("get","chartsBackground");return"string"==typeof t?t:Promise.reject("unexpected response received from iframe")}async setChartsBackground(t){if("string"!=typeof t)return Promise.reject("chartsBackground property value should be a string");await this._send("set","chartsBackground",t)}async isShowAttribution(){const[t]=await this._send("get","attribution");return"boolean"==typeof t?Boolean(t):Promise.reject("unexpected response received from iframe")}async setShowAttribution(t){if("boolean"!=typeof t)return Promise.reject("showAttribution property value should be a boolean");await this._send("set","attribution",t)}async getWidthMode(){const[t]=await this._send("get","scalingWidth");return t===Fo.FIXED||t===Fo.SCALE?t:Promise.reject("unexpected response received from iframe")}async setWidthMode(t){if(!["fixed","scale"].includes(t))return Promise.reject('widthMode property value should be a string value of "fixed" or "scale"');await this._send("set","scalingWidth",t)}async getHeightMode(){const[t]=await this._send("get","scalingHeight");return"fixed"===t||"scale"===t?t:Promise.reject("unexpected response received from iframe")}async setHeightMode(t){if(!["fixed","scale"].includes(t))return Promise.reject('heightMode property value should be a string value of "fixed" or "scale"');await this._send("set","scalingHeight",t)}async getChart(t){if(!this.charts[t]){const[e]=await this._send("get","charts",[t]);if(!Array.isArray(e))return Promise.reject("unexpected response received from iframe");if(1!==e.length)return Promise.reject("Invalid chart id: "+t);this.charts[t]=new ei(t,this)}return this.charts[t]}async getAllCharts(){const[t]=await this._send("get","charts");if(!Array.isArray(t))return Promise.reject("unexpected response received from iframe");const e=[];return t.forEach((t=>{this.charts[t]||(this.charts[t]=new ei(t,this)),e.push(this.charts[t])})),e}_configureHost(t){return super._configureHost(t).on("event",((t,e,r)=>{const n=e.chartId;this.charts[n]._handleEvent(t,e,r)}))}}class ii{constructor(t){var e,r,n;n=void 0,(r="defaultOptions")in(e=this)?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,this.defaultOptions=t}createChart(t){return new Qo({...this.defaultOptions,...t})}createDashboard(t){return new oi({...this.defaultOptions,...t})}}function si(t,e,r){const n=t.slice();return n[3]=e[r],n[4]=e,n[5]=r,n}function ai(t){let e,r=t[4],n=t[5];const o=()=>t[1](e,r,n),i=()=>t[1](null,r,n);return{c(){e=d("div"),b(e,"class","col")},m(t,r){h(t,e,r),o()},p(e,s){r===(t=e)[4]&&n===t[5]||(i(),r=t[4],n=t[5],o())},d(t){t&&l(e),i()}}}function ui(t){let r,n=DR_CHART_IDS,o=[];for(let e=0;e<n.length;e+=1)o[e]=ai(si(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();r=m()},m(t,e){for(let r=0;r<o.length;r+=1)o[r].m(t,e);h(t,r,e)},p(t,[e]){if(0&e){let i;for(n=DR_CHART_IDS,i=0;i<n.length;i+=1){const s=si(t,n,i);o[i]?o[i].p(s,e):(o[i]=ai(s),o[i].c(),o[i].m(r.parentNode,r))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},i:e,o:e,d(t){p(o,t),t&&l(r)}}}function ci(t,e,r){let{startDate:n=new Date}=e;return S((async()=>{!async function(){const t=new ii({baseUrl:DR_CHART_BASE_URL});for(const e of DR_CHART_IDS){const r=t.createChart({chartId:e.id,height:"300px",filter:{ts:{$gt:n}},maxDataAge:10,showAttribution:!1});await r.render(e.elm).catch((()=>console.log("Error while rendering chart")))}}()})),t.$$set=t=>{"startDate"in t&&r(0,n=t.startDate)},[n,function(t,e,r){$[t?"unshift":"push"]((()=>{e[r].elm=t}))}]}class fi extends K{constructor(t){super(),G(this,t,ci,ui,s,{startDate:0})}}function hi(t){let r,n,o,i;return{c(){r=d("button"),n=g(t[0]),b(r,"type","button"),b(r,"class","btn btn-primary"),r.disabled=t[1]},m(e,s){h(e,r,s),f(r,n),o||(i=v(r,"click",t[2]),o=!0)},p(t,[e]){1&e&&w(n,t[0]),2&e&&(r.disabled=t[1])},i:e,o:e,d(t){t&&l(r),o=!1,i()}}}const li="Atlas regional failover";function pi(t,e,r){let{appServerEndpoint:n}=e,o=li,i=!1;return t.$$set=t=>{"appServerEndpoint"in t&&r(3,n=t.appServerEndpoint)},[o,i,async function(){try{(await fetch(n+"/testFailover",{method:"POST"})).ok&&(r(1,i=!0),r(0,o="Initiated regional failover..."),setTimeout((()=>{r(1,i=!1),r(0,o=li)}),6e5))}catch(t){console.log(`Test failover failed: ${t}`)}},n]}class di extends K{constructor(t){super(),G(this,t,pi,hi,s,{appServerEndpoint:3})}}function gi(t){let e,r,n,i,s,a,u,c,p,g,m,w,E,x,S,O,j,A,$,N,B,I,R,U,C;return n=new di({props:{appServerEndpoint:t[3]}}),{c(){e=d("div"),r=d("div"),z(n.$$.fragment),i=y(),s=d("div"),a=d("input"),u=y(),c=d("label"),c.textContent="Retryable reads",p=y(),g=d("div"),m=d("input"),w=y(),E=d("label"),E.textContent="Retryable writes",x=y(),S=d("div"),O=d("select"),j=d("option"),j.textContent="primary",A=d("option"),A.textContent="primaryPreferred",$=d("option"),$.textContent="secondary",N=d("option"),N.textContent="secondaryPreferred",B=y(),I=d("label"),I.textContent="Read preference",b(r,"class","actions svelte-1gzwlrb"),b(a,"class","form-check-input svelte-1gzwlrb"),b(a,"type","checkbox"),a.__value="",a.value=a.__value,b(c,"class","form-check-label"),b(c,"for","flexCheckChecked"),b(s,"class","form-check"),b(m,"class","form-check-input svelte-1gzwlrb"),b(m,"type","checkbox"),m.__value="",m.value=m.__value,b(E,"class","form-check-label"),b(E,"for","flexCheckChecked"),b(g,"class","form-check"),j.__value="primary",j.value=j.__value,j.selected=!0,A.__value="primaryPreferred",A.value=A.__value,$.__value="secondary",$.value=$.__value,N.__value="secondaryPreferred",N.value=N.__value,b(O,"class","form-select"),b(O,"id","read-preference"),b(O,"aria-label","Read preference"),void 0===t[2]&&T((()=>t[6].call(O))),b(I,"for","read-preference"),b(S,"class","form-floating svelte-1gzwlrb"),b(e,"class","controls svelte-1gzwlrb"),b(e,"role","group"),b(e,"aria-label","simulate failure menu")},m(o,l){h(o,e,l),f(e,r),W(n,r,null),f(e,i),f(e,s),f(s,a),a.checked=t[0],f(s,u),f(s,c),f(e,p),f(e,g),f(g,m),m.checked=t[1],f(g,w),f(g,E),f(e,x),f(e,S),f(S,O),f(O,j),f(O,A),f(O,$),f(O,N),_(O,t[2]),f(S,B),f(S,I),R=!0,U||(C=[v(a,"change",t[4]),v(m,"change",t[5]),v(O,"change",t[6])],U=!0)},p(t,[e]){const r={};8&e&&(r.appServerEndpoint=t[3]),n.$set(r),1&e&&(a.checked=t[0]),2&e&&(m.checked=t[1]),4&e&&_(O,t[2])},i(t){R||(q(n.$$.fragment,t),R=!0)},o(t){J(n.$$.fragment,t),R=!1},d(t){t&&l(e),Z(n),U=!1,o(C)}}}function yi(t,e,r){let{retryReads:n=!0}=e,{retryWrites:o=!0}=e,{readPreference:i="primary"}=e,{appServerEndpoint:s}=e;return t.$$set=t=>{"retryReads"in t&&r(0,n=t.retryReads),"retryWrites"in t&&r(1,o=t.retryWrites),"readPreference"in t&&r(2,i=t.readPreference),"appServerEndpoint"in t&&r(3,s=t.appServerEndpoint)},[n,o,i,s,function(){n=this.checked,r(0,n)},function(){o=this.checked,r(1,o)},function(){i=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),r(2,i)}]}class mi extends K{constructor(t){super(),G(this,t,yi,gi,s,{retryReads:0,retryWrites:1,readPreference:2,appServerEndpoint:3})}}function vi(t){let r,n,o,i,s,a,u,p,m,v;return{c(){r=d("div"),n=d("figure"),o=d("img"),a=y(),u=d("figcaption"),p=g(t[1]),m=g(" — "),v=g(t[2]),c(o.src,i="img/"+t[1]+"-active.png")||b(o,"src",i),b(o,"class","figure-img svelte-1xxiser"),b(o,"alt",s=t[1]+" node"),b(u,"class","figure-caption"),b(n,"class","figure"),b(r,"class","col-3 text-center")},m(e,i){h(e,r,i),f(r,n),f(n,o),t[3](o),f(n,a),f(n,u),f(u,p),f(u,m),f(u,v)},p(t,[e]){2&e&&!c(o.src,i="img/"+t[1]+"-active.png")&&b(o,"src",i),2&e&&s!==(s=t[1]+" node")&&b(o,"alt",s),2&e&&w(p,t[1]),4&e&&w(v,t[2])},i:e,o:e,d(e){e&&l(r),t[3](null)}}}function bi(t,e,r){let{type:n="TYPE"}=e,{region:o="REGION"}=e,{iconElm:i}=e;return t.$$set=t=>{"type"in t&&r(1,n=t.type),"region"in t&&r(2,o=t.region),"iconElm"in t&&r(0,i=t.iconElm)},[i,n,o,function(t){$[t?"unshift":"push"]((()=>{i=t,r(0,i)}))}]}class wi extends K{constructor(t){super(),G(this,t,bi,vi,s,{type:1,region:2,iconElm:0})}}function _i(t,e,r){const n=t.slice();return n[8]=e[r],n[9]=e,n[10]=r,n}function Ei(t){let e,r,n;function o(e){t[2](e,t[8])}let i={type:t[8].type,region:t[8].region};return void 0!==t[8].iconElm&&(i.iconElm=t[8].iconElm),e=new wi({props:i}),$.push((()=>V(e,"iconElm",o))),{c(){z(e.$$.fragment)},m(t,r){W(e,t,r),n=!0},p(n,o){t=n;const i={};1&o&&(i.type=t[8].type),1&o&&(i.region=t[8].region),!r&&1&o&&(r=!0,i.iconElm=t[8].iconElm,U((()=>r=!1))),e.$set(i)},i(t){n||(q(e.$$.fragment,t),n=!0)},o(t){J(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function xi(t){let e,r,n=t[0],o=[];for(let e=0;e<n.length;e+=1)o[e]=Ei(_i(t,n,e));const i=t=>J(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=m()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);h(t,e,n),r=!0},p(t,[r]){if(1&r){let s;for(n=t[0],s=0;s<n.length;s+=1){const i=_i(t,n,s);o[s]?(o[s].p(i,r),q(o[s],1)):(o[s]=Ei(i),o[s].c(),q(o[s],1),o[s].m(e.parentNode,e))}for(H(),s=n.length;s<o.length;s+=1)i(s);F()}},i(t){if(!r){for(let t=0;t<n.length;t+=1)q(o[t]);r=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)J(o[t]);r=!1},d(t){p(o,t),t&&l(e)}}}const Si="/getClusterDetails";function Oi(t,e,r){let n,{appServerEndpoint:o}=e,{nodes:i=[]}=e,s=!1;async function a(){try{const t=await fetch(o+"/hello"),e=await t.json();if(e&&e.tags&&e.tags.region&&e.me===e.primary){const t=i.findIndex((t=>t.region===e.tags.region));-1!==t&&"Primary"!==i[t].type&&i[t].host!==e.me&&(i.forEach((t=>t.type="Secondary")),r(0,i[t].type="Primary",i),r(0,i[t].host=e.me,i))}else console.log(`Could not determine primary. Connected to: ${e.me}`);!function(){if(!s)for(let t=1;t<i.length;t++)i[t-1].iconElm&&i[t].iconElm&&(new LeaderLine(i[t-1].iconElm,i[t].iconElm,{color:"grey",startPlug:"behind",endPlug:"behind"}),s=!0)}()}catch(t){console.log(`Fetching output of db hello command failed: ${t}`)}}return S((async()=>{!async function(){try{const t=await fetch(o+Si),e=await t.json();if(e&&e.replicationSpec)for(const t in e.replicationSpec)r(0,i=[...i,{region:t,type:"Secondary"}]);a()}catch(t){console.log(`Fetching cluster config failed: ${t}`)}}()})),j((()=>{clearInterval(n)})),Q.subscribe((t=>{t?n=setInterval(a,1e3):clearInterval(n)})),O((async()=>{})),t.$$set=t=>{"appServerEndpoint"in t&&r(1,o=t.appServerEndpoint),"nodes"in t&&r(0,i=t.nodes)},[i,o,function(e,n){t.$$.not_equal(n.iconElm,e)&&(n.iconElm=e,r(0,i))}]}class ji extends K{constructor(t){super(),G(this,t,Oi,xi,s,{appServerEndpoint:1,nodes:0})}}function Ai(t,e,r){const n=t.slice();return n[4]=e[r],n}function $i(t){let e,r,n,o,i,s,a,u,c,p=Qi(t[4].created)+"",m=t[4].eventTypeName+"";return{c(){e=d("tr"),r=d("td"),n=d("span"),o=g(p),i=g(":"),s=y(),a=d("td"),u=g(m),c=y(),b(n,"class","text-muted"),b(a,"class","text-end")},m(t,l){h(t,e,l),f(e,r),f(r,n),f(n,o),f(n,i),f(e,s),f(e,a),f(a,u),f(e,c)},p(t,e){1&e&&p!==(p=Qi(t[4].created)+"")&&w(o,p),1&e&&m!==(m=t[4].eventTypeName+"")&&w(u,m)},d(t){t&&l(e)}}}function Ni(t){let r,n,o,i,s,a=t[0].reverse(),u=[];for(let e=0;e<a.length;e+=1)u[e]=$i(Ai(t,a,e));return{c(){r=d("div"),n=d("div"),o=d("p"),o.textContent="Cluster event log",i=y(),s=d("table");for(let t=0;t<u.length;t+=1)u[t].c();b(o,"class","h5"),b(s,"class","text-start float-end"),b(n,"id","cluster-events"),b(n,"class","text-end svelte-5mk11n"),b(r,"class","col")},m(t,e){h(t,r,e),f(r,n),f(n,o),f(n,i),f(n,s);for(let t=0;t<u.length;t+=1)u[t].m(s,null)},p(t,[e]){if(1&e){let r;for(a=t[0].reverse(),r=0;r<a.length;r+=1){const n=Ai(t,a,r);u[r]?u[r].p(n,e):(u[r]=$i(n),u[r].c(),u[r].m(s,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=a.length}},i:e,o:e,d(t){t&&l(r),p(u,t)}}}function Bi(t,e,r){let n,{appServerEndpoint:o}=e,i=[];async function s(){try{const t=o+"/getClusterEvents?minDate="+function(){const t=new Date;return t.setSeconds(t.getSeconds()-10),t.toISOString()}(),e=await fetch(t,{method:"GET"}),n=await e.json();e.ok&&n&&n.results&&r(0,i=i.concat(n.results))}catch(t){console.log(`Get Atlas Cluster events failed: ${t}`)}}return S((()=>{})),j((()=>{clearInterval(n)})),Q.subscribe((t=>{t?n=setInterval(s,1e4):clearInterval(n)})),t.$$set=t=>{"appServerEndpoint"in t&&r(1,o=t.appServerEndpoint)},[i,o]}class Ii extends K{constructor(t){super(),G(this,t,Bi,Ni,s,{appServerEndpoint:1})}}function Ri(t){let r,n,o,i,s,a;return{c(){r=d("button"),n=g(t[0]),o=d("i"),b(o,"class",i="bi "+t[1]+" svelte-1v82big"),b(r,"type","button"),b(r,"class","btn btn-primary svelte-1v82big")},m(e,i){h(e,r,i),f(r,n),f(r,o),s||(a=v(r,"click",t[2]),s=!0)},p(t,[e]){1&e&&w(n,t[0]),2&e&&i!==(i="bi "+t[1]+" svelte-1v82big")&&b(o,"class",i)},i:e,o:e,d(t){t&&l(r),s=!1,a()}}}const Ti="/stop";function Ui(t,e,r){let n,{appServerEndpoint:o}=e,{retryReads:i}=e,{retryWrites:s}=e,{readPreference:a}=e,u="Start",c="bi-play-fill";async function f(){try{const t=await fetch(o+"/continue"),e=await t.json();t.ok&&e&&e.success?console.log("Send keep running signal"):console.log(`Error! Got invalid response: ${e.msg}`)}catch(t){console.log(`Error while sending continue signal to appserver: ${t}`)}}return j((()=>{clearInterval(n)})),t.$$set=t=>{"appServerEndpoint"in t&&r(3,o=t.appServerEndpoint),"retryReads"in t&&r(4,i=t.retryReads),"retryWrites"in t&&r(5,s=t.retryWrites),"readPreference"in t&&r(6,a=t.readPreference)},[u,c,function(){Q.update((t=>(t?(clearInterval(n),async function(){try{const t=await fetch(o+Ti),e=await t.json();t.ok&&e&&e.success?console.log("Stopping"):console.log(`Error! Got invalid response: ${e.msg}`)}catch(t){console.log(`Error while stopping appserver: ${t}`)}}()):(!async function(){try{const t=`${o}/start?retryReads=${i}&retryWrites=${s}&readPreference=${a}`,e=await fetch(t),r=await e.json();e.ok&&r&&r.success?console.log(`Started: ${r.msg}`):console.log(`Error! Got invalid response: ${r.msg}`)}catch(t){console.log(`Error while starting appserver: ${t}`)}}(),n=setInterval(f,5e3)),r(0,u=(t=!t)?"Stop":"Start"),r(1,c=t?"bi-stop-fill":"bi-play-fill"),t)))},o,i,s,a]}class Ci extends K{constructor(t){super(),G(this,t,Ui,Ri,s,{appServerEndpoint:3,retryReads:4,retryWrites:5,readPreference:6})}}function Mi(t){let e,r,n=t[0].avg&&Pi(t),o=t[0].max&&ki(t);return{c(){n&&n.c(),e=y(),o&&o.c(),r=m()},m(t,i){n&&n.m(t,i),h(t,e,i),o&&o.m(t,i),h(t,r,i)},p(t,i){t[0].avg?n?n.p(t,i):(n=Pi(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),t[0].max?o?o.p(t,i):(o=ki(t),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},d(t){n&&n.d(t),t&&l(e),o&&o.d(t),t&&l(r)}}}function Pi(t){let e,r,n,o,i,s,a=parseFloat(t[0].avg).toFixed(2)+"";return{c(){e=d("div"),r=d("p"),r.textContent="Average latency:",n=y(),o=d("p"),i=g(a),s=g(" ms"),b(r,"class","svelte-1i86akd"),b(o,"class","h5 svelte-1i86akd"),b(e,"class","col col-lg-2 svelte-1i86akd")},m(t,a){h(t,e,a),f(e,r),f(e,n),f(e,o),f(o,i),f(o,s)},p(t,e){1&e&&a!==(a=parseFloat(t[0].avg).toFixed(2)+"")&&w(i,a)},d(t){t&&l(e)}}}function ki(t){let e,r,n,o,i,s,a=t[0].max+"";return{c(){e=d("div"),r=d("p"),r.textContent="Max latency:",n=y(),o=d("p"),i=g(a),s=g(" ms"),b(r,"class","svelte-1i86akd"),b(o,"class","h5 svelte-1i86akd"),b(e,"class","col col-lg-2 svelte-1i86akd")},m(t,a){h(t,e,a),f(e,r),f(e,n),f(e,o),f(o,i),f(o,s)},p(t,e){1&e&&a!==(a=t[0].max+"")&&w(i,a)},d(t){t&&l(e)}}}function Li(t){let r,n=t[0]&&Mi(t);return{c(){n&&n.c(),r=m()},m(t,e){n&&n.m(t,e),h(t,r,e)},p(t,[e]){t[0]?n?n.p(t,e):(n=Mi(t),n.c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},i:e,o:e,d(t){n&&n.d(t),t&&l(r)}}}function Di(t,e,r){let n,{appServerEndpoint:o}=e,{startDate:i}=e,s={};async function a(){try{const t=await fetch(o+"/getStats?minDate="+i.getTime());r(0,s=await t.json())}catch(t){console.log(`Error while fetching stats: ${t}`)}}return S((()=>{})),j((()=>{clearInterval(n)})),Q.subscribe((t=>{t?n=setInterval(a,1e3):clearInterval(n)})),t.$$set=t=>{"appServerEndpoint"in t&&r(1,o=t.appServerEndpoint),"startDate"in t&&r(2,i=t.startDate)},[s,o,i]}class Hi extends K{constructor(t){super(),G(this,t,Di,Li,s,{appServerEndpoint:1,startDate:2})}}function Fi(t,e,r){const n=t.slice();return n[14]=e[r],n}function qi(t,e,r){const n=t.slice();return n[14]=e[r],n}function Ji(t){let e,r;return e=new ut({props:{region:t[14].region,mongoNodes:t[1]}}),{c(){z(e.$$.fragment)},m(t,n){W(e,t,n),r=!0},p(t,r){const n={};1&r&&(n.region=t[14].region),2&r&&(n.mongoNodes=t[1]),e.$set(n)},i(t){r||(q(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){Z(e,t)}}}function Vi(t){let e,r,n=t[14].endpoint&&t[14].region&&Ji(t);return{c(){n&&n.c(),e=m()},m(t,o){n&&n.m(t,o),h(t,e,o),r=!0},p(t,r){t[14].endpoint&&t[14].region?n?(n.p(t,r),1&r&&q(n,1)):(n=Ji(t),n.c(),q(n,1),n.m(e.parentNode,e)):n&&(H(),J(n,1,1,(()=>{n=null})),F())},i(t){r||(q(n),r=!0)},o(t){J(n),r=!1},d(t){n&&n.d(t),t&&l(e)}}}function zi(t){let e,r;return e=new Hi({props:{appServerEndpoint:t[7],startDate:t[6]}}),{c(){z(e.$$.fragment)},m(t,n){W(e,t,n),r=!0},p(t,r){const n={};64&r&&(n.startDate=t[6]),e.$set(n)},i(t){r||(q(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){Z(e,t)}}}function Wi(t){let e,r;return e=new fi({props:{startDate:t[6]}}),{c(){z(e.$$.fragment)},m(t,n){W(e,t,n),r=!0},p(t,r){const n={};64&r&&(n.startDate=t[6]),e.$set(n)},i(t){r||(q(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){Z(e,t)}}}function Zi(t){let e,r;return e=new it({props:{appServerEndpoint:t[14].endpoint,region:t[14].region}}),{c(){z(e.$$.fragment)},m(t,n){W(e,t,n),r=!0},p(t,r){const n={};1&r&&(n.appServerEndpoint=t[14].endpoint),1&r&&(n.region=t[14].region),e.$set(n)},i(t){r||(q(e.$$.fragment,t),r=!0)},o(t){J(e.$$.fragment,t),r=!1},d(t){Z(e,t)}}}function Yi(t){let e,r,n=t[5]&&t[14].endpoint&&Zi(t);return{c(){n&&n.c(),e=m()},m(t,o){n&&n.m(t,o),h(t,e,o),r=!0},p(t,r){t[5]&&t[14].endpoint?n?(n.p(t,r),33&r&&q(n,1)):(n=Zi(t),n.c(),q(n,1),n.m(e.parentNode,e)):n&&(H(),J(n,1,1,(()=>{n=null})),F())},i(t){r||(q(n),r=!0)},o(t){J(n),r=!1},d(t){n&&n.d(t),t&&l(e)}}}function Gi(t){let e,r,n,o,i,s,a,u,c,g,m,v,w,_,E,x,S,O,j,A,N,B,I,R,T,C,M,P,k,L,D;function Y(e){t[8](e)}function G(e){t[9](e)}function K(e){t[10](e)}a=new Ci({props:{appServerEndpoint:t[7],retryReads:t[2],retryWrites:t[3],readPreference:t[4]}});let X={appServerEndpoint:t[7]};void 0!==t[2]&&(X.retryReads=t[2]),void 0!==t[3]&&(X.retryWrites=t[3]),void 0!==t[4]&&(X.readPreference=t[4]),m=new mi({props:X}),$.push((()=>V(m,"retryReads",Y))),$.push((()=>V(m,"retryWrites",G))),$.push((()=>V(m,"readPreference",K)));let Q=t[0],tt=[];for(let e=0;e<Q.length;e+=1)tt[e]=Vi(qi(t,Q,e));const et=t=>J(tt[t],1,1,(()=>{tt[t]=null}));function rt(e){t[11](e)}let nt={appServerEndpoint:t[7]};void 0!==t[1]&&(nt.nodes=t[1]),A=new ji({props:nt}),$.push((()=>V(A,"nodes",rt))),R=new Ii({props:{appServerEndpoint:t[7]}});let ot=t[5]&&zi(t),it=t[5]&&Wi(t),st=t[0],at=[];for(let e=0;e<st.length;e+=1)at[e]=Yi(Fi(t,st,e));const ut=t=>J(at[t],1,1,(()=>{at[t]=null}));return{c(){e=d("main"),r=d("div"),n=d("div"),o=d("div"),i=d("h1"),i.textContent="Disaster Simulator®",s=y(),z(a.$$.fragment),u=y(),c=d("div"),g=d("div"),z(m.$$.fragment),E=y(),x=d("div"),S=d("div");for(let t=0;t<tt.length;t+=1)tt[t].c();O=y(),j=d("div"),z(A.$$.fragment),B=y(),I=d("div"),z(R.$$.fragment),T=y(),C=d("div"),ot&&ot.c(),M=y(),P=d("div"),it&&it.c(),k=y(),L=d("div");for(let t=0;t<at.length;t+=1)at[t].c();b(o,"class","col text-center"),b(n,"class","row header-row svelte-xx1ngb"),b(g,"class","col-2"),b(S,"class","row justify-content-center appserver-row svelte-xx1ngb"),b(j,"class","row justify-content-center"),b(x,"class","col-8 topology"),b(I,"class","col-2"),b(c,"class","row"),b(C,"class","row justify-content-md-center"),b(P,"class","row chart-row"),b(L,"class","row"),b(r,"class","container"),b(e,"class","svelte-xx1ngb")},m(t,l){h(t,e,l),f(e,r),f(r,n),f(n,o),f(o,i),f(o,s),W(a,o,null),f(r,u),f(r,c),f(c,g),W(m,g,null),f(c,E),f(c,x),f(x,S);for(let t=0;t<tt.length;t+=1)tt[t].m(S,null);f(x,O),f(x,j),W(A,j,null),f(c,B),f(c,I),W(R,I,null),f(r,T),f(r,C),ot&&ot.m(C,null),f(r,M),f(r,P),it&&it.m(P,null),f(r,k),f(r,L);for(let t=0;t<at.length;t+=1)at[t].m(L,null);D=!0},p(t,[e]){const r={};4&e&&(r.retryReads=t[2]),8&e&&(r.retryWrites=t[3]),16&e&&(r.readPreference=t[4]),a.$set(r);const n={};if(!v&&4&e&&(v=!0,n.retryReads=t[2],U((()=>v=!1))),!w&&8&e&&(w=!0,n.retryWrites=t[3],U((()=>w=!1))),!_&&16&e&&(_=!0,n.readPreference=t[4],U((()=>_=!1))),m.$set(n),3&e){let r;for(Q=t[0],r=0;r<Q.length;r+=1){const n=qi(t,Q,r);tt[r]?(tt[r].p(n,e),q(tt[r],1)):(tt[r]=Vi(n),tt[r].c(),q(tt[r],1),tt[r].m(S,null))}for(H(),r=Q.length;r<tt.length;r+=1)et(r);F()}const o={};if(!N&&2&e&&(N=!0,o.nodes=t[1],U((()=>N=!1))),A.$set(o),t[5]?ot?(ot.p(t,e),32&e&&q(ot,1)):(ot=zi(t),ot.c(),q(ot,1),ot.m(C,null)):ot&&(H(),J(ot,1,1,(()=>{ot=null})),F()),t[5]?it?(it.p(t,e),32&e&&q(it,1)):(it=Wi(t),it.c(),q(it,1),it.m(P,null)):it&&(H(),J(it,1,1,(()=>{it=null})),F()),33&e){let r;for(st=t[0],r=0;r<st.length;r+=1){const n=Fi(t,st,r);at[r]?(at[r].p(n,e),q(at[r],1)):(at[r]=Yi(n),at[r].c(),q(at[r],1),at[r].m(L,null))}for(H(),r=st.length;r<at.length;r+=1)ut(r);F()}},i(t){if(!D){q(a.$$.fragment,t),q(m.$$.fragment,t);for(let t=0;t<Q.length;t+=1)q(tt[t]);q(A.$$.fragment,t),q(R.$$.fragment,t),q(ot),q(it);for(let t=0;t<st.length;t+=1)q(at[t]);D=!0}},o(t){J(a.$$.fragment,t),J(m.$$.fragment,t),tt=tt.filter(Boolean);for(let t=0;t<tt.length;t+=1)J(tt[t]);J(A.$$.fragment,t),J(R.$$.fragment,t),J(ot),J(it),at=at.filter(Boolean);for(let t=0;t<at.length;t+=1)J(at[t]);D=!1},d(t){t&&l(e),Z(a),Z(m),p(tt,t),Z(A),Z(R),ot&&ot.d(),it&&it.d(),p(at,t)}}}function Ki(t,e,r){const n="/region";let o,i,s,a,u,c=[],f=DR_APP_HOSTS[0],h=[];return S((()=>{!async function(){const t=[];for(let e of DR_APP_HOSTS)try{const r=await fetch(e+n),o=await r.text();t.push({region:o,endpoint:e})}catch(t){console.log(`Fetching app region failed: ${t}`)}r(0,c=t)}()})),Q.subscribe((t=>{r(5,a=t),t&&r(6,u=new Date)})),[c,h,o,i,s,a,u,f,function(t){o=t,r(2,o)},function(t){i=t,r(3,i)},function(t){s=t,r(4,s)},function(t){h=t,r(1,h)}]}const Xi=new class extends K{constructor(t){super(),G(this,t,Ki,Gi,s,{})}}({target:document.body,props:{}});function Qi(t){return new Date(t).toLocaleString("en-US",{hour:"2-digit",hour12:!1,minute:"2-digit",second:"2-digit"})}return t.default=Xi,t.getTimestamp=Qi,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=bundle.js.map
